<!-- <link rel="stylesheet" href="css/bootstrap.css"> -->
<!-- <link rel="stylesheet" href="../css/bootstrap.min.css"> -->

   <!-- Debut Style CSS pour eliminer les ascenseurs sur les Input de type Numeric -->
    <style >

        /* Firefox */

        

        /* Chrome */

        input::-webkit-inner-spin-button,

        input::-webkit-outer-spin-button {

            -webkit-appearance: none;

            margin:0;

        }

        /* OpÃ©ra*/

        input::-o-inner-spin-button,

        input::-o-outer-spin-button {

            -o-appearance: none;

            margin:0

        }

    </style>

<!-- Fin Style CSS pour eliminer les ascenseurs sur les Input de type Numeric -->



<!-- Debut Javascript de l'Accordion pour Tout les Paniers -->
<!-- <script type="text/javascript" src="js/jquery-3.1.1.min.js"></script> -->
    <script type="text/javascript" src="js/pagination.js"></script>
    <script >

        $(function() {

        $(".expand").on( "click", function() {

            // $(this).next().slideToggle(200);

            $expand = $(this).find(">:first-child");



            if($expand.text() == "+") {

            $expand.text("-");

            } else {

            $expand.text("+");

            }

        });

        });
        

        // var blink_speed = 500; 

        // var t = setInterval(function () {

        //         var ele = document.getElementById('blinker'); 

        //         ele.style.visibility = (ele.style.visibility == 'hidden' ? '' : 'hidden'); 

        //     }, blink_speed);

        //     function showPreviewPanier(event,idPagnet) {
        //     var file = document.getElementById('input_file_Panier'+idPagnet).value;
        //     var reader = new FileReader();
        //     reader.onload = function(){
        //         var format = file.substr(file.length - 3);
        //         var pdf = document.getElementById('output_pdf_Panier'+idPagnet);
        //         var image = document.getElementById('output_image_Panier'+idPagnet);
        //         if(format=='pdf'){
        //             document.getElementById('output_pdf_Panier'+idPagnet).style.display = "block";
        //             document.getElementById('output_image_Panier'+idPagnet).style.display = "none";
        //             pdf.src = reader.result;
        //         }
        //         else{
        //             document.getElementById('output_image_Panier'+idPagnet).style.display = "block";
        //             document.getElementById('output_pdf_Panier'+idPagnet).style.display = "none";
        //             image.src = reader.result;
        //         }
        //     }
        //     reader.readAsDataURL(event.target.files[0]);
        //     document.getElementById('btn_upload_Panier'+idPagnet).style.display = "block";
        // }

        
        paniers=JSON.parse(localStorage.getItem("pagnet"));
        users=JSON.parse(localStorage.getItem("Boutique"));
        date=new Date();
        datejour=date.toLocaleDateString("es-CL");
        
        seachUser=users.find(u =>u.idutilisateur==sessionStorage.iduserSession)
        chaine=seachUser.prenom
        prenom = chaine.slice(0, 3);
                            
        if(paniers!=null){ 
            lesPaniers= paniers.filter(p =>p.datepagej==datejour)
            if(lesPaniers.length > 10){
                for(var i=lesPaniers.length-10; i<lesPaniers.length; i++){
                    //var val=parseInt(lesPaniers[i].idPagnet);
                    //users= paniers.filter(p =>p.datepagej==datejour)
                    //var numPanier=val+1
                    if(lesPaniers[i].verrouiller==1 && lesPaniers[i].iduser==sessionStorage.iduserSession){
                        
                        //paniers= lesPaniers.filter(p =>p.datepagej==datejour);
                        var numPanier=0
                        // for(var j=0; j<paniers.length;j++){
                        //     numPanier=j+1
                        
                        // var numPanier=0
                        //numPanier=i+1
                        if(lesPaniers[i].type==30){
                            if(lesPaniers[i].synchronise==0){
                                var p= '<div class="panel panel-warnig" id=panelPanier'+lesPaniers[i].idPagnet+'>'+

                                '<div class="panel-heading">'+

                                    '<h4 data-toggle="collapse" data-parent="#accordion" href="#pagnet'+lesPaniers[i].idPagnet+'"  class="panel-title expand">'+

                                        '<div class="right-arrow pull-right">+</div>'+

                                        '<a class="row" href="#">'+ 

                                            '<span class="noImpr col-md-2 col-sm-2 col-xs-12" id=paniertermine'+lesPaniers[i].idPagnet+'> Panier '+(i+1)+'</span>'+

                                            '<span class="noImpr col-md-1 col-sm-2 col-xs-12">'+lesPaniers[i].heurePagnet+'</span>'+

                                            '<span class="noImpr col-md-2 col-sm-2 col-xs-12" >Total panier: <span id=somme_Total'+lesPaniers[i].idPagnet+' >'+lesPaniers[i].totalp+'</span></span>'+

                                            '<span class="noImpr col-md-2 col-sm-3 col-xs-12" >Total A  payer: <span id=somme_Apayer'+lesPaniers[i].idPagnet+' >'+lesPaniers[i].apayerPagnet+'</span></span>'+ 

                                            '<span class="noImpr col-md-2 col-sm-3 col-xs-12" > Facture : #'+(i+1)+'</span>'+

                                            '<span class="noImpr col-md-2 col-sm-3 col-xs-12"> '+prenom.toUpperCase()+'</span>'+                

                                        '</a>'+

                                    '</h4>'+

                                '</div>'+
                                '<div id=pagnet'+lesPaniers[i].idPagnet+' class="panel-collapse collapse" > '+

                                    '<div class="panel-body" >'+

                                //<!--*******************************Debut Retourner Pagnet****************************************-->'+

                                '<button type="submit" 	 class="btn btn-danger pull-right" data-toggle="modal" data-target=#msg_rtrn_pagnet'+lesPaniers[i].idPagnet+'>'+

                                        '<span class="glyphicon glyphicon-remove"></span>Retourner'+

                                '</button >'+



                                '<div class="modal fade" id="msg_rtrn_pagnet'+lesPaniers[i].idPagnet+'" role="dialog">'+

                                    '<div class="modal-dialog">'+


                                        '<div class="modal-content">'+

                                            '<div class="modal-header panel-primary">'+

                                                '<button type="button" class="close" data-dismiss="modal">&times;</button >'+

                                                '<h4 class="modal-title">Confirmation</h4>'+

                                            '</div>'+

                                            '<form  class="form-inline noImpr"  id="factForm" method="post"  >'+

                                                '<div class="modal-body">'+

                                                    '<p>Voulez-vous retourner le panier numéro <b>'+lesPaniers[i].idPagnet+'"<b></p>'+

                                                    '<input type="hidden" name="idPagnet" id="idPagnet"  value='+lesPaniers[i].idPagnet+'>'+

                                                '</div>'+

                                                '<div class="modal-footer">'+

                                                    '<button type="button" class="btn btn-default" data-dismiss="modal">Close</button >'+

                                                    '<button type="button" name="btnRetournerPagnet" data-idPanier='+lesPaniers[i].idPagnet+' class="btn btn-success btnRetournerPagnet">Confirmer<img src="images/loading-gif3.gif" class="img-load-retournerPanier" style="height: 30px;width: 30px; display:none;" alt="GIF" srcset=""></button >'+

                                                '</div>'+

                                            '</form>'+

                                        '</div>'+

                                    '</div>'+

                                '</div>'+

                                //<!--*******************************Fin Retourner Pagnet****************************************-->'+



                                //<!--*******************************Debut Editer Pagnet****************************************-->'+


                                '<button type="button" class="btn btn-primary pull-left modeEditionBtn" id="edit-'+lesPaniers[i].idPagnet+'">'+

                                    '<span class="glyphicon glyphicon-edit"></span> Editer<img src="images/loading-gif3.gif" class="img-load-editer" style="height: 30px;width: 30px;display:none;" alt="GIF" srcset="">'+

                                '</button >'+



                                '<div class="modal fade" id="msg_edit_pagnet'+lesPaniers[i].idPagnet+'" role="dialog">'+

                                    '<div class="modal-dialog">'+

                                        '<div class="modal-content">'+

                                            '<div class="modal-header panel-primary">'+

                                                '<button type="button" class="close" data-dismiss="modal">&times;</button >'+

                                                '<h4 class="modal-title">Alert</h4>'+

                                            '</div>'+

                                            '<p>Une erreur est survenu lors de l\'édition. <br>'+

                                                'Veuillez ressayer!</p>'+

                                        '</div>'+

                                    '</div>'+

                                '</div>'+


                                //<!--*******************************Fin Editer Pagnet****************************************-->'+



                                //<!--*******************************Debut Facture****************************************-->'+




                                    '<button type="submit" class="btn btn-warning pull-right" style="margin-right:20px;" data-toggle="modal" data-target=#msg_fact_pagnet'+lesPaniers[i].idPagnet+'>'+

                                        'Facture'+

                                    '</button >'+






                                '<div class="modal fade" id="msg_fact_pagnet'+lesPaniers[i].idPagnet+'" role="dialog">'+

                                    '<div class="modal-dialog">'+

                                        //<!-- Modal content-->'+

                                        '<div class="modal-content">'+

                                            '<div class="modal-header panel-primary">'+

                                                '<button type="button" class="close" data-dismiss="modal">&times;</button >'+

                                                '<h4 class="modal-title">Informations Client</h4>'+

                                            '</div>'+

                                            '<form  class=" noImpr"  method="post"  id="idPanierFac'+lesPaniers[i].idPagnet+'"  value="'+lesPaniers[i].idPagnet+'" >'+

                                                    '<div class="modal-body">'+

                                                        '<div class="form-group">'+

                                                            '<label for="inputEmail3" class="control-label">Nom Complet </label>'+

                                                            '<input type="text" class="form-control" name="entreprise" id="nomclient'+lesPaniers[i].idPagnet+'" required="" placeholder="Le nom complet ici...">'+

                                                        '</div>'+

                                                        '<div class="row">'+

                                                            '<div class="col-xs-6">'+

                                                                '<label for="reference">Adresse Client</label>'+

                                                                '<input type="text" class="form-control" name="adresse" id="adresseclient'+lesPaniers[i].idPagnet+'">'+

                                                            '</div>'+

                                                            '<div class="col-xs-6">'+

                                                                '<label for="reference">Telephone Client</label>'+

                                                                '<input type="text" class="form-control" name="telephone" id="telephone'+lesPaniers[i].idPagnet+'" >'+

                                                            '</div>'+

                                                        '</div>'+

                                                        '<input type="hidden" name="idPagnet" id="idPanierF" value="'+lesPaniers[i].idPagnet+'">'+

                                                    '</div>'+

                                                    '<div class="modal-footer">'+

                                                        '<button type="button" class="btn btn-default" data-dismiss="modal">Close</button >'+

                                                        '<button type="submit" name="btnFacture" class="btn btn-success"'+
                                                        'onclick="imprimerFacture('+lesPaniers[i].idPagnet+')">Confirmer</button >'+

                                                    '</div>'+

                                                '</form>'+

                                        '</div>'+

                                    '</div>'+

                                '</div>'+

                                //<!--*******************************Fin Facture****************************************-->'+




                                '<button  class="btn btn-info  pull-right" style="margin-right:20px;" onclick="imprimerTicket('+lesPaniers[i].idPagnet+')">'+

                                    'Ticket de Caisse'+

                                '</button >'+






                                '<form  class="form-inline pull-right noImpr" id="ticket'+lesPaniers[i].idPagnet+'"  target="_blank" style="margin-right:20px;"'+

                                'method="post" action="ticketCaisse.html" >'+

                                '<input type="hidden" name="idPagnet" id="idPagnet"  value='+lesPaniers[i].idPagnet+' >'+

                                '</form>'+


                                        '<table  id=tablePanier'+lesPaniers[i].idPagnet+' class="tabPanier table"  width="100%" >'+

                                            '<thead>'+

                                                '<tr>'+

                                                    '<th>Référence</th>'+

                                                    '<th>Quantité</th>'+

                                                    '<th>Unité Vente</th>'+

                                                    '<th>Prix Unité Vente</th>'+

                                                '</tr>'+

                                            '</thead>'+

                                            '<tbody>'+
                                            
                                                

                                                
                                            '</tbody>'+

                                        '</table>'+
                                        '<div>'+

                                            '<div>********************************************* <br/>TOTAL : '+lesPaniers[i].totalp+'<br/></div>'+

                                            '<div id="remise"><br/></div>'+

                                            '<div id="apayer"><b>Net A  payer : '+lesPaniers[i].apayerPagnet+'</b><br/></div>'+

                                            '<div id="compte"><br/></div>'+

                                            '<div id="espece"><br/></div>'+

                                            '<div id="rendu"><br/></div>'+

                                            '<div id="avance"><br/></div>'+

                                            '<div id="reste"><br/></div>'+

                                            '<div id="compte2"><br/></div>'+

                                        '</div>'+
                                        

                                    '</div>'+

                                    '</div>'+
                                '</div>';

                                $("#accordion").prepend(p); 
                                var lignes=JSON.parse(localStorage.getItem("ligne"));
                                if(lignes!=null){
                                for(var j=0; j<lignes.length; j++){
                                    if(lesPaniers[i].idPagnet==lignes[j].idPagnet){
                                        var l="<tr>" +

                                                    "<td>" + lignes[j].designation + "</td>" +

                                                    "<td>"+lignes[j].quantite+"</td>" +

                                                    "<td>"+lignes[j].unitevente+"</td>" +

                                                    "<td>"+lignes[j].prixunitevente +"</td>" +
                                                
                                                    '<td>'+

                                                        '<button  type="submit" 	 class="btn btn-danger pull-right" data-toggle="modal" data-target="#msg_rtrnApres_ligne'+lignes[j].numligne+'">'+

                                                                '<span class="glyphicon glyphicon-remove"></span>Retour'+

                                                        '</button>'+



                                                        '<div class="modal fade" id="msg_rtrnApres_ligne'+lignes[j].numligne+'" role="dialog">'+

                                                            '<div class="modal-dialog">'+

                                                                //<!-- Modal content-->'+

                                                                '<div class="modal-content">'+

                                                                    '<div class="modal-header panel-primary">'+

                                                                        '<button type="button" class="close" data-dismiss="modal">&times;</button>'+

                                                                        '<h4 class="modal-title">Confirmation</h4>'+

                                                                    '</div>'+

                                                                    '<form class="form-inline noImpr" id="factForm" method="post" >'+

                                                                        '<div class="modal-body">'+

                                                                            '<p>Voulez-vous retourner cette ligne du panier numéro <b>'+idPanier+'</b></p>'+

                                                                            // '<input type="hidden" name="idPagnet" id="idPagnet2618" value=1725 >'+

                                                                            // '<input type="hidden" name="designation" id="designation2618" value=Farine de niebe >'+

                                                                            // '<input type="hidden" name="numligne" id="numligne2618" value=2618 >'+

                                                                            // '<input type="hidden" name="idStock" id="idStock2618" value=0 >'+

                                                                            // '<input type="hidden" name="unitevente" id="unitevente2618" value=article >'+

                                                                            // '<input type="hidden" name="prixunitevente" id="prixunitevente2618" value=750 >'+

                                                                            // '<input type="hidden" name="prixtotal" id="prixtotal2618" value=750 >'+

                                                                            // '<input type="hidden" name="totalp" id="totalp2618" value=750 >'+

                                                                            '<div class="row">'+

                                                                                '<div class="col-xs-6">'+

                                                                                    '<label for="reference">Ancienne quantite </label>'+

                                                                                    '<input type="text" disabled="true" class="form-control" value=1 >'+

                                                                                '</div>'+

                                                                                '<div class="col-xs-6">'+

                                                                                    '<label for="reference">Nouvelle quantite</label>'+

                                                                                    '<input type="text" class="form-control inputRetourApres" name="quantite" data-numligne="'+lignes[j].numligne+'" id="quantite'+lignes[j].numligne+'" value=1 >'+

                                                                                '</div>'+

                                                                            '</div>'+

                                                                        '</div>'+

                                                                        '<div class="modal-footer">'+

                                                                            '<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>'+

                                                                            '<button type="button"  name="btnRetourApres" data-numligne="'+lignes[j].numligne+'" class="btn btn-success btnRetourApres">Confirmer'+

                                                                                '<img src="images/loading-gif3.gif" class="img-load-retourApres" style="height: 30px;width: 30px; display:none;" alt="GIF" srcset=""> </button>'+

                                                                        '</div>'+

                                                                    '</form>'+

                                                                '</div>'+

                                                            '</div>'+

                                                        '</div>'+
                                                    '</td>'+


                                                "</tr>";

                                        $("#tablePanier"+lesPaniers[i].idPagnet).prepend(l);

                                        var searchPanier=lesPaniers.find(p =>p.idPagnet==lesPaniers[i].idPagnet);
                                        var lesComptes=getCompte();
                                        

                                        var searchCompte=lesComptes.find(c =>c.idCompte==lesPaniers[i].idCompte);  
                                        

                                        document.getElementById('compte').innerHTML='Compte : '+searchCompte.nomCompte

                                        if(searchPanier.remise==0){
                                            divRemise='<div></div>';
                                            document.getElementById('remise').innerHTML=divRemise
                                            //$('#remise').hide
                                            
                                        
                                        }
                                        else{
                                            document.getElementById('remise').innerHTML='Remise : '+searchPanier.remise
                                        }
                                        if(searchPanier.versement==0){
                                            divEspece='<div></div>';
                                            divRendu='<div></div>';
                                            document.getElementById('espece').innerHTML=divEspece
                                            document.getElementById('rendu').innerHTML=divRendu
                                            // $('#espece').hide
                                            // $('#rendu').hide
                                        }
                                        else{

                                            document.getElementById('espece').innerHTML='Espèce : '+searchPanier.versement
                                            document.getElementById('rendu').innerHTML='Rendu : '+searchPanier.restourne
                                        }
                                        if(searchPanier.avance==0 || searchPanier.avance==""){
                                            divAvance='<div></div>';
                                            divReste='<div></div>';
                                            document.getElementById('avance').innerHTML=divAvance
                                            document.getElementById('reste').innerHTML=divReste
                                            
                                        }
                                        else{
                                            
                                            document.getElementById('avance').innerHTML='Avance : '+searchPanier.avance
                                            document.getElementById('reste').innerHTML='Reste : '+parseInt(searchPanier.apayerPagnet-searchPanier.avance)
                                            var idCompte2=localStorage.getItem('idCompte2')
                                            var searchCompte=lesComptes.find(c =>c.idCompte==idCompte2);
                                            
                                            document.getElementById('compte2').innerHTML='Compte avance : '+searchCompte.nomCompte
                                            
                                            
                                        }
                                    }
                                }
                            }


                        }
                            else{
                                    var p= '<div class="panel panel-info" id=panelPanier'+lesPaniers[i].idPagnet+'>'+

                                    '<div class="panel-heading">'+

                                        '<h4 data-toggle="collapse" data-parent="#accordion" href="#pagnet'+lesPaniers[i].idPagnet+'"  class="panel-title expand">'+

                                            '<div class="right-arrow pull-right">+</div>'+

                                            '<a class="row" href="#">'+ 

                                                '<span class="noImpr col-md-2 col-sm-2 col-xs-12" id=paniertermine'+lesPaniers[i].idPagnet+'> Panier '+(i+1)+'</span>'+

                                                '<span class="noImpr col-md-1 col-sm-2 col-xs-12">'+lesPaniers[i].heurePagnet+'</span>'+

                                                '<span class="noImpr col-md-2 col-sm-2 col-xs-12" >Total panier: <span id=somme_Total'+lesPaniers[i].idPagnet+' >'+lesPaniers[i].totalp+'</span></span>'+

                                                '<span class="noImpr col-md-2 col-sm-3 col-xs-12" >Total A  payer: <span id=somme_Apayer'+lesPaniers[i].idPagnet+' >'+lesPaniers[i].apayerPagnet+'</span></span>'+ 

                                                '<span class="noImpr col-md-2 col-sm-3 col-xs-12" > Facture : #'+(i+1)+'</span>'+

                                                '<span class="noImpr col-md-2 col-sm-3 col-xs-12">'+prenom.toUpperCase()+'</span>'+                

                                            '</a>'+

                                        '</h4>'+

                                    '</div>'+
                                    '<div id=pagnet'+lesPaniers[i].idPagnet+' class="panel-collapse collapse" > '+

                                        '<div class="panel-body" >'+

                                    //<!--*******************************Debut Retourner Pagnet****************************************-->'+

                                    '<button type="submit" 	 class="btn btn-danger pull-right" data-toggle="modal" data-target=#msg_rtrn_pagnet'+lesPaniers[i].idPagnet+'>'+

                                            '<span class="glyphicon glyphicon-remove"></span>Retourner'+

                                    '</button >'+



                                    '<div class="modal fade" id="msg_rtrn_pagnet'+lesPaniers[i].idPagnet+'" role="dialog">'+

                                        '<div class="modal-dialog">'+


                                            '<div class="modal-content">'+

                                                '<div class="modal-header panel-primary">'+

                                                    '<button type="button" class="close" data-dismiss="modal">&times;</button >'+

                                                    '<h4 class="modal-title">Confirmation</h4>'+

                                                '</div>'+

                                                '<form  class="form-inline noImpr"  id="factForm" method="post"  >'+

                                                    '<div class="modal-body">'+

                                                        '<p>Voulez-vous retourner le panier numéro <b>'+lesPaniers[i].idPagnet+'"<b></p>'+

                                                        '<input type="hidden" name="idPagnet" id="idPagnet"  value='+lesPaniers[i].idPagnet+'>'+

                                                    '</div>'+

                                                    '<div class="modal-footer">'+

                                                        '<button type="button" class="btn btn-default" data-dismiss="modal">Close</button >'+

                                                        '<button type="button" name="btnRetournerPagnet" data-idPanier='+lesPaniers[i].idPagnet+' class="btn btn-success btnRetournerPagnet">Confirmer<img src="images/loading-gif3.gif" class="img-load-retournerPanier" style="height: 30px;width: 30px; display:none;" alt="GIF" srcset=""></button >'+

                                                    '</div>'+

                                                '</form>'+

                                            '</div>'+

                                        '</div>'+

                                    '</div>'+

                                    //<!--*******************************Fin Retourner Pagnet****************************************-->'+



                                    //<!--*******************************Debut Editer Pagnet****************************************-->'+


                                    '<button type="button" class="btn btn-primary pull-left modeEditionBtn" id="edit-'+lesPaniers[i].idPagnet+'">'+

                                        '<span class="glyphicon glyphicon-edit"></span> Editer<img src="images/loading-gif3.gif" class="img-load-editer" style="height: 30px;width: 30px;display:none;" alt="GIF" srcset="">'+

                                    '</button >'+



                                    '<div class="modal fade" id="msg_edit_pagnet'+lesPaniers[i].idPagnet+'" role="dialog">'+

                                        '<div class="modal-dialog">'+

                                            '<div class="modal-content">'+

                                                '<div class="modal-header panel-primary">'+

                                                    '<button type="button" class="close" data-dismiss="modal">&times;</button >'+

                                                    '<h4 class="modal-title">Alert</h4>'+

                                                '</div>'+

                                                '<p>Une erreur est survenu lors de l\'édition. <br>'+

                                                    'Veuillez ressayer!</p>'+

                                            '</div>'+

                                        '</div>'+

                                    '</div>'+


                                    //<!--*******************************Fin Editer Pagnet****************************************-->'+



                                    //<!--*******************************Debut Facture****************************************-->'+




                                        '<button type="submit" class="btn btn-warning pull-right" style="margin-right:20px;" data-toggle="modal" data-target=#msg_fact_pagnet'+lesPaniers[i].idPagnet+'>'+

                                            'Facture'+

                                        '</button >'+






                                    '<div class="modal fade" id="msg_fact_pagnet'+lesPaniers[i].idPagnet+'" role="dialog">'+

                                        '<div class="modal-dialog">'+

                                            //<!-- Modal content-->'+

                                            '<div class="modal-content">'+

                                                '<div class="modal-header panel-primary">'+

                                                    '<button type="button" class="close" data-dismiss="modal">&times;</button >'+

                                                    '<h4 class="modal-title">Informations Client</h4>'+

                                                '</div>'+

                                                '<form  class=" noImpr"  method="post"  id="idPanierFac'+lesPaniers[i].idPagnet+'"  value="'+lesPaniers[i].idPagnet+'" >'+

                                                        '<div class="modal-body">'+

                                                            '<div class="form-group">'+

                                                                '<label for="inputEmail3" class="control-label">Nom Complet </label>'+

                                                                '<input type="text" class="form-control" name="entreprise" id="nomclient'+lesPaniers[i].idPagnet+'" required="" placeholder="Le nom complet ici...">'+

                                                            '</div>'+

                                                            '<div class="row">'+

                                                                '<div class="col-xs-6">'+

                                                                    '<label for="reference">Adresse Client</label>'+

                                                                    '<input type="text" class="form-control" name="adresse" id="adresseclient'+lesPaniers[i].idPagnet+'">'+

                                                                '</div>'+

                                                                '<div class="col-xs-6">'+

                                                                    '<label for="reference">Telephone Client</label>'+

                                                                    '<input type="text" class="form-control" name="telephone" id="telephone'+lesPaniers[i].idPagnet+'" >'+

                                                                '</div>'+

                                                            '</div>'+

                                                            '<input type="hidden" name="idPagnet" id="idPanierF" value="'+lesPaniers[i].idPagnet+'">'+

                                                        '</div>'+

                                                        '<div class="modal-footer">'+

                                                            '<button type="button" class="btn btn-default" data-dismiss="modal">Close</button >'+

                                                            '<button type="submit" name="btnFacture" class="btn btn-success"'+
                                                            'onclick="imprimerFacture('+lesPaniers[i].idPagnet+')">Confirmer</button >'+

                                                        '</div>'+

                                                    '</form>'+

                                            '</div>'+

                                        '</div>'+

                                    '</div>'+

                                    //<!--*******************************Fin Facture****************************************-->'+




                                    '<button  class="btn btn-info  pull-right" style="margin-right:20px;" onclick="imprimerTicket('+lesPaniers[i].idPagnet+')">'+

                                        'Ticket de Caisse'+

                                    '</button >'+






                                    '<form  class="form-inline pull-right noImpr" id="ticket'+lesPaniers[i].idPagnet+'"  target="_blank" style="margin-right:20px;"'+

                                    'method="post" action="ticketCaisse.html" >'+

                                    '<input type="hidden" name="idPagnet" id="idPagnet"  value='+lesPaniers[i].idPagnet+' >'+

                                    '</form>'+


                                            '<table  id=tablePanier'+lesPaniers[i].idPagnet+' class="tabPanier table"  width="100%" >'+

                                                '<thead>'+

                                                    '<tr>'+

                                                        '<th>Référence</th>'+

                                                        '<th>Quantité</th>'+

                                                        '<th>Unité Vente</th>'+

                                                        '<th>Prix Unité Vente</th>'+

                                                    '</tr>'+

                                                '</thead>'+

                                                '<tbody>'+
                                                
                                                    

                                                    
                                                '</tbody>'+

                                            '</table>'+
                                            '<div>'+

                                                '<div>********************************************* <br/>TOTAL : '+lesPaniers[i].totalp+'<br/></div>'+

                                                '<div id="remise"><br/></div>'+

                                                '<div id="apayer"><b>Net A  payer : '+lesPaniers[i].apayerPagnet+'</b><br/></div>'+

                                                '<div id="compte"><br/></div>'+

                                                '<div id="espece"><br/></div>'+

                                                '<div id="rendu"><br/></div>'+

                                                '<div id="avance"><br/></div>'+

                                                '<div id="reste"><br/></div>'+

                                                '<div id="compte2"><br/></div>'+

                                            '</div>'+
                                            

                                        '</div>'+

                                        '</div>'+
                                    '</div>';

                                    $("#accordion").prepend(p); 
                                    var lignes=JSON.parse(localStorage.getItem("ligne"));
                                    if(lignes!=null){
                                    for(var j=0; j<lignes.length; j++){
                                        if(lesPaniers[i].idPagnet==lignes[j].idPagnet){
                                            var l="<tr>" +

                                                        "<td>" + lignes[j].designation + "</td>" +

                                                        "<td>"+lignes[j].quantite+"</td>" +

                                                        "<td>"+lignes[j].unitevente+"</td>" +

                                                        "<td>"+lignes[j].prixunitevente +"</td>" +
                                                    
                                                        '<td>'+

                                                            '<button  type="submit" 	 class="btn btn-danger pull-right" data-toggle="modal" data-target="#msg_rtrnApres_ligne'+lignes[j].numligne+'">'+

                                                                    '<span class="glyphicon glyphicon-remove"></span>Retour'+

                                                            '</button>'+



                                                            '<div class="modal fade" id="msg_rtrnApres_ligne'+lignes[j].numligne+'" role="dialog">'+

                                                                '<div class="modal-dialog">'+

                                                                    //<!-- Modal content-->'+

                                                                    '<div class="modal-content">'+

                                                                        '<div class="modal-header panel-primary">'+

                                                                            '<button type="button" class="close" data-dismiss="modal">&times;</button>'+

                                                                            '<h4 class="modal-title">Confirmation</h4>'+

                                                                        '</div>'+

                                                                        '<form class="form-inline noImpr" id="factForm" method="post" >'+

                                                                            '<div class="modal-body">'+

                                                                                '<p>Voulez-vous retourner cette ligne du panier numéro <b>'+idPanier+'</b></p>'+

                                                                                // '<input type="hidden" name="idPagnet" id="idPagnet2618" value=1725 >'+

                                                                                // '<input type="hidden" name="designation" id="designation2618" value=Farine de niebe >'+

                                                                                // '<input type="hidden" name="numligne" id="numligne2618" value=2618 >'+

                                                                                // '<input type="hidden" name="idStock" id="idStock2618" value=0 >'+

                                                                                // '<input type="hidden" name="unitevente" id="unitevente2618" value=article >'+

                                                                                // '<input type="hidden" name="prixunitevente" id="prixunitevente2618" value=750 >'+

                                                                                // '<input type="hidden" name="prixtotal" id="prixtotal2618" value=750 >'+

                                                                                // '<input type="hidden" name="totalp" id="totalp2618" value=750 >'+

                                                                                '<div class="row">'+

                                                                                    '<div class="col-xs-6">'+

                                                                                        '<label for="reference">Ancienne quantite </label>'+

                                                                                        '<input type="text" disabled="true" class="form-control" value=1 >'+

                                                                                    '</div>'+

                                                                                    '<div class="col-xs-6">'+

                                                                                        '<label for="reference">Nouvelle quantite</label>'+

                                                                                        '<input type="text" class="form-control inputRetourApres" name="quantite" data-numligne="'+lignes[j].numligne+'" id="quantite'+lignes[j].numligne+'" value=1 >'+

                                                                                    '</div>'+

                                                                                '</div>'+

                                                                            '</div>'+

                                                                            '<div class="modal-footer">'+

                                                                                '<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>'+

                                                                                '<button type="button"  name="btnRetourApres" data-numligne="'+lignes[j].numligne+'" class="btn btn-success btnRetourApres">Confirmer'+

                                                                                    '<img src="images/loading-gif3.gif" class="img-load-retourApres" style="height: 30px;width: 30px; display:none;" alt="GIF" srcset=""> </button>'+

                                                                            '</div>'+

                                                                        '</form>'+

                                                                    '</div>'+

                                                                '</div>'+

                                                            '</div>'+
                                                        '</td>'+


                                                    "</tr>";

                                            $("#tablePanier"+lesPaniers[i].idPagnet).prepend(l);

                                            var searchPanier=lesPaniers.find(p =>p.idPagnet==lesPaniers[i].idPagnet);
                                            var lesComptes=getCompte();

                                            var searchCompte=lesComptes.find(c =>c.idCompte==lesPaniers[i].idCompte);  
                                            

                                            //alert(searchPanier.remise)
                                            
                                            document.getElementById('compte').innerHTML='Compte : '+searchCompte.nomCompte

                                            if(searchPanier.remise==0){
                                                divRemise='<div></div>';
                                                document.getElementById('remise').innerHTML=divRemise
                                                //$('#remise').hide
                                                
                                            
                                            }
                                            else{
                                                document.getElementById('remise').innerHTML='Remise : '+searchPanier.remise
                                            }
                                            if(searchPanier.versement==0){
                                                divEspece='<div></div>';
                                                divRendu='<div></div>';
                                                document.getElementById('espece').innerHTML=divEspece
                                                document.getElementById('rendu').innerHTML=divRendu
                                                // $('#espece').hide
                                                // $('#rendu').hide
                                            }
                                            else{

                                                document.getElementById('espece').innerHTML='Espèce : '+searchPanier.versement
                                                document.getElementById('rendu').innerHTML='Rendu : '+searchPanier.restourne
                                            }
                                            if(searchPanier.avance==0 || searchPanier.avance==""){
                                                divAvance='<div></div>';
                                                divReste='<div></div>';
                                                document.getElementById('avance').innerHTML=divAvance
                                                document.getElementById('reste').innerHTML=divReste
                                                // document.getElementById('avance').innerHTML='Avance : '+searchPanier.avance
                                                // document.getElementById('reste').innerHTML='Reste : '+parseInt(searchPanier.apayerPagnet-searchPanier.avance)
                                                // var idCompte2=localStorage.getItem('idCompte2')
                                                // var searchCompte=lesComptes.find(c =>c.idCompte==idCompte2);
                                                
                                                // document.getElementById('compte2').innerHTML='Compte avance : '+searchCompte.nomCompte
                                            }
                                            else{
                                                
                                                document.getElementById('avance').innerHTML='Avance : '+searchPanier.avance
                                                document.getElementById('reste').innerHTML='Reste : '+parseInt(searchPanier.apayerPagnet-searchPanier.avance)
                                                var idCompte2=localStorage.getItem('idCompte2')
                                                var searchCompte=lesComptes.find(c =>c.idCompte==idCompte2);
                                                
                                                document.getElementById('compte2').innerHTML='Compte avance : '+searchCompte.nomCompte
                                                
                                                
                                            }
                                        }
                                    }
                                    }


                                }
                        }else{
                            if(lesPaniers[i].synchronise==0){
                                //alert('OK')
                                var p= '<div class="panel panel-warning" id=panelPanier'+lesPaniers[i].idPagnet+'>'+

                                    '<div class="panel-heading">'+

                                        '<h4 data-toggle="collapse" data-parent="#accordion" href="#pagnet'+lesPaniers[i].idPagnet+'"  class="panel-title expand">'+

                                            '<div class="right-arrow pull-right">+</div>'+

                                            '<a class="row" href="#">'+ 

                                                '<span class="noImpr col-md-2 col-sm-2 col-xs-12" id=paniertermine'+lesPaniers[i].idPagnet+'> Panier '+(i+1)+'</span>'+

                                                '<span class="noImpr col-md-1 col-sm-2 col-xs-12">'+lesPaniers[i].heurePagnet+'</span>'+

                                                '<span class="noImpr col-md-2 col-sm-2 col-xs-12" >Total panier: <span id=somme_Total'+lesPaniers[i].idPagnet+' >'+lesPaniers[i].totalp+'</span></span>'+

                                                '<span class="noImpr col-md-2 col-sm-3 col-xs-12" >Total A  payer: <span id=somme_Apayer'+lesPaniers[i].idPagnet+' >'+lesPaniers[i].apayerPagnet+'</span></span>'+ 

                                                '<span class="noImpr col-md-2 col-sm-3 col-xs-12" > Facture : #'+(i+1)+'</span>'+

                                                '<span class="noImpr col-md-2 col-sm-3 col-xs-12">'+prenom.toUpperCase()+'</span>'+                

                                            '</a>'+

                                        '</h4>'+

                                    '</div>'+
                                    '<div id=pagnet'+lesPaniers[i].idPagnet+' class="panel-collapse collapse" > '+

                                        '<div class="panel-body" >'+

                                    //<!--*******************************Debut Retourner Pagnet****************************************-->'+

                                    '<button type="submit" 	 class="btn btn-danger pull-right" data-toggle="modal" data-target=#msg_rtrn_pagnet'+lesPaniers[i].idPagnet+'>'+

                                            '<span class="glyphicon glyphicon-remove"></span>Retourner'+

                                    '</button >'+



                                    '<div class="modal fade" id="msg_rtrn_pagnet'+lesPaniers[i].idPagnet+'" role="dialog">'+

                                        '<div class="modal-dialog">'+


                                            '<div class="modal-content">'+

                                                '<div class="modal-header panel-primary">'+

                                                    '<button type="button" class="close" data-dismiss="modal">&times;</button >'+

                                                    '<h4 class="modal-title">Confirmation</h4>'+

                                                '</div>'+

                                                '<form  class="form-inline noImpr"  id="factForm" method="post"  >'+

                                                    '<div class="modal-body">'+

                                                        '<p>Voulez-vous retourner le panier numéro <b>'+lesPaniers[i].idPagnet+'"<b></p>'+

                                                        '<input type="hidden" name="idPagnet" id="idPagnet"  value='+lesPaniers[i].idPagnet+'>'+

                                                    '</div>'+

                                                    '<div class="modal-footer">'+

                                                        '<button type="button" class="btn btn-default" data-dismiss="modal">Close</button >'+

                                                        '<button type="button" name="btnRetournerPagnet" data-idPanier='+lesPaniers[i].idPagnet+' class="btn btn-success btnRetournerPagnet">Confirmer<img src="images/loading-gif3.gif" class="img-load-retournerPanier" style="height: 30px;width: 30px; display:none;" alt="GIF" srcset=""></button >'+

                                                    '</div>'+

                                                '</form>'+

                                            '</div>'+

                                        '</div>'+

                                    '</div>'+

                                    //<!--*******************************Fin Retourner Pagnet****************************************-->'+



                                    //<!--*******************************Debut Editer Pagnet****************************************-->'+


                                    '<button type="button" class="btn btn-primary pull-left modeEditionBtn" id="edit-'+lesPaniers[i].idPagnet+'">'+

                                        '<span class="glyphicon glyphicon-edit"></span> Editer<img src="images/loading-gif3.gif" class="img-load-editer" style="height: 30px;width: 30px;display:none;" alt="GIF" srcset="">'+

                                    '</button >'+



                                    '<div class="modal fade" id="msg_edit_pagnet'+lesPaniers[i].idPagnet+'" role="dialog">'+

                                        '<div class="modal-dialog">'+

                                            '<div class="modal-content">'+

                                                '<div class="modal-header panel-primary">'+

                                                    '<button type="button" class="close" data-dismiss="modal">&times;</button >'+

                                                    '<h4 class="modal-title">Alert</h4>'+

                                                '</div>'+

                                                '<p>Une erreur est survenu lors de l\'édition. <br>'+

                                                    'Veuillez ressayer!</p>'+

                                            '</div>'+

                                        '</div>'+

                                    '</div>'+


                                    //<!--*******************************Fin Editer Pagnet****************************************-->'+



                                    //<!--*******************************Debut Facture****************************************-->'+




                                        '<button type="submit" class="btn btn-warning pull-right" style="margin-right:20px;" data-toggle="modal" data-target=#msg_fact_pagnet'+lesPaniers[i].idPagnet+'>'+

                                            'Facture'+

                                        '</button >'+






                                    '<div class="modal fade" id="msg_fact_pagnet'+lesPaniers[i].idPagnet+'" role="dialog">'+

                                        '<div class="modal-dialog">'+

                                            //<!-- Modal content-->'+

                                            '<div class="modal-content">'+

                                                '<div class="modal-header panel-primary">'+

                                                    '<button type="button" class="close" data-dismiss="modal">&times;</button >'+

                                                    '<h4 class="modal-title">Informations Client</h4>'+

                                                '</div>'+

                                                '<form  class=" noImpr"  method="post"  id="idPanierFac'+lesPaniers[i].idPagnet+'"  value="'+lesPaniers[i].idPagnet+'" >'+

                                                        '<div class="modal-body">'+

                                                            '<div class="form-group">'+

                                                                '<label for="inputEmail3" class="control-label">Nom Complet </label>'+

                                                                '<input type="text" class="form-control" name="entreprise" id="nomclient'+lesPaniers[i].idPagnet+'" required="" placeholder="Le nom complet ici...">'+

                                                            '</div>'+

                                                            '<div class="row">'+

                                                                '<div class="col-xs-6">'+

                                                                    '<label for="reference">Adresse Client</label>'+

                                                                    '<input type="text" class="form-control" name="adresse" id="adresseclient'+lesPaniers[i].idPagnet+'">'+

                                                                '</div>'+

                                                                '<div class="col-xs-6">'+

                                                                    '<label for="reference">Telephone Client</label>'+

                                                                    '<input type="text" class="form-control" name="telephone" id="telephone'+lesPaniers[i].idPagnet+'" >'+

                                                                '</div>'+

                                                            '</div>'+

                                                            '<input type="hidden" name="idPagnet" id="idPanierF" value="'+lesPaniers[i].idPagnet+'">'+

                                                        '</div>'+

                                                        '<div class="modal-footer">'+

                                                            '<button type="button" class="btn btn-default" data-dismiss="modal">Close</button >'+

                                                            '<button type="submit" name="btnFacture" class="btn btn-success"'+
                                                            'onclick="imprimerFacture('+lesPaniers[i].idPagnet+')">Confirmer</button >'+

                                                        '</div>'+

                                                    '</form>'+

                                            '</div>'+

                                        '</div>'+

                                    '</div>'+

                                    //<!--*******************************Fin Facture****************************************-->'+




                                    '<button  class="btn btn-info  pull-right" style="margin-right:20px;" onclick="imprimerTicket('+lesPaniers[i].idPagnet+')">'+

                                        'Ticket de Caisse'+

                                    '</button >'+






                                    '<form  class="form-inline pull-right noImpr" id="ticket'+lesPaniers[i].idPagnet+'"  target="_blank" style="margin-right:20px;"'+

                                    'method="post" action="ticketCaisse.html" >'+

                                    '<input type="hidden" name="idPagnet" id="idPagnet"  value='+lesPaniers[i].idPagnet+' >'+

                                    '</form>'+


                                            '<table  id=tablePanier'+lesPaniers[i].idPagnet+' class="tabPanier table"  width="100%" >'+

                                                '<thead>'+

                                                    '<tr>'+

                                                        '<th>Référence</th>'+

                                                        '<th>Quantité</th>'+

                                                        '<th>Unité Vente</th>'+

                                                        '<th>Prix Unité Vente</th>'+

                                                    '</tr>'+

                                                '</thead>'+

                                                '<tbody>'+
                                                
                                                    

                                                    
                                                '</tbody>'+

                                            '</table>'+
                                            '<div>'+

                                            '<div>********************************************* <br/>TOTAL : '+lesPaniers[i].totalp+'</div>'+

                                            '<div id="remise"></div>'+

                                            '<div id="apayer"><b>Net A  payer : '+lesPaniers[i].apayerPagnet+'</b></div>'+

                                            '<div id="compte"></div>'+

                                            '<div id="espece"></div>'+

                                            '<div id="rendu"></div>'+

                                            '<div id="avance"></div>'+

                                            '<div id="reste"></div>'+

                                            '<div id="compte2"></div>'+

                                            '</div>'+

                                        '</div>'+

                                        '</div>'+
                                    '</div>';
                                                
                                    $("#accordion").prepend(p); 
                                    var lignes=JSON.parse(localStorage.getItem("ligne"));
                                    if(lignes!=null){
                                    for(var j=0; j<lignes.length; j++){
                                        if(lesPaniers[i].idPagnet==lignes[j].idPagnet){
                                            var l="<tr>" +

                                                        "<td>" + lignes[j].designation + "</td>" +

                                                        "<td>"+lignes[j].quantite+"</td>" +

                                                        "<td>"+lignes[j].unitevente+"</td>" +

                                                        "<td>"+lignes[j].prixunitevente +"</td>" +
                                                    
                                                        '<td>'+

                                                            '<button  type="submit" 	 class="btn btn-danger pull-right" data-toggle="modal" data-target="#msg_rtrnApres_ligne'+lignes[j].numligne+'">'+

                                                                    '<span class="glyphicon glyphicon-remove"></span>Retour'+

                                                            '</button>'+



                                                            '<div class="modal fade" id="msg_rtrnApres_ligne'+lignes[j].numligne+'" role="dialog">'+

                                                                '<div class="modal-dialog">'+

                                                                    //<!-- Modal content-->'+

                                                                    '<div class="modal-content">'+

                                                                        '<div class="modal-header panel-primary">'+

                                                                            '<button type="button" class="close" data-dismiss="modal">&times;</button>'+

                                                                            '<h4 class="modal-title">Confirmation</h4>'+

                                                                        '</div>'+

                                                                        '<form class="form-inline noImpr" id="factForm" method="post" >'+

                                                                            '<div class="modal-body">'+

                                                                                '<p>Voulez-vous retourner cette ligne du panier numéro <b>'+idPanier+'</b></p>'+

                                                                                // '<input type="hidden" name="idPagnet" id="idPagnet2618" value=1725 >'+

                                                                                // '<input type="hidden" name="designation" id="designation2618" value=Farine de niebe >'+

                                                                                // '<input type="hidden" name="numligne" id="numligne2618" value=2618 >'+

                                                                                // '<input type="hidden" name="idStock" id="idStock2618" value=0 >'+

                                                                                // '<input type="hidden" name="unitevente" id="unitevente2618" value=article >'+

                                                                                // '<input type="hidden" name="prixunitevente" id="prixunitevente2618" value=750 >'+

                                                                                // '<input type="hidden" name="prixtotal" id="prixtotal2618" value=750 >'+

                                                                                // '<input type="hidden" name="totalp" id="totalp2618" value=750 >'+

                                                                                '<div class="row">'+

                                                                                    '<div class="col-xs-6">'+

                                                                                        '<label for="reference">Ancienne quantite </label>'+

                                                                                        '<input type="text" disabled="true" class="form-control" value=1 >'+

                                                                                    '</div>'+

                                                                                    '<div class="col-xs-6">'+

                                                                                        '<label for="reference">Nouvelle quantite</label>'+

                                                                                        '<input type="text" class="form-control inputRetourApres" name="quantite" data-numligne="'+lignes[j].numligne+'" id="quantite'+lignes[j].numligne+'" value=1 >'+

                                                                                    '</div>'+

                                                                                '</div>'+

                                                                            '</div>'+

                                                                            '<div class="modal-footer">'+

                                                                                '<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>'+

                                                                                '<button type="button"  name="btnRetourApres" data-numligne="'+lignes[j].numligne+'" class="btn btn-success btnRetourApres">Confirmer'+

                                                                                    '<img src="images/loading-gif3.gif" class="img-load-retourApres" style="height: 30px;width: 30px; display:none;" alt="GIF" srcset=""> </button>'+

                                                                            '</div>'+

                                                                        '</form>'+

                                                                    '</div>'+

                                                                '</div>'+

                                                            '</div>'+
                                                        '</td>'+


                                                    "</tr>";

                                            $("#tablePanier"+lesPaniers[i].idPagnet).prepend(l);

                                            var searchPanier=lesPaniers.find(p =>p.idPagnet==lesPaniers[i].idPagnet);
                                            var lesComptes=getCompte();

                                            var searchCompte=lesComptes.find(c =>c.idCompte==searchPanier.idCompte);  
                                            

                                            //alert(searchPanier.remise)
                                            
                                            document.getElementById('compte').innerHTML='Compte : '+searchCompte.nomCompte

                                            if(searchPanier.remise==0){
                                                divRemise='<div></div>';
                                                document.getElementById('remise').innerHTML=divRemise
                                                //$('#remise').hide
                                                
                                            
                                            }
                                            else{
                                                document.getElementById('remise').innerHTML='Remise : '+searchPanier.remise
                                            }
                                            if(searchPanier.versement==0){
                                                divEspece='<div></div>';
                                                divRendu='<div></div>';
                                                document.getElementById('espece').innerHTML=divEspece
                                                document.getElementById('rendu').innerHTML=divRendu
                                                // $('#espece').hide
                                                // $('#rendu').hide
                                            }
                                            else{

                                                document.getElementById('espece').innerHTML='Espèce : '+searchPanier.versement
                                                document.getElementById('rendu').innerHTML='Rendu : '+searchPanier.restourne
                                            }
                                            if(searchPanier.avance==0 || searchPanier.avance==""){
                                                divAvance='<div></div>';
                                                divReste='<div></div>';
                                                document.getElementById('avance').innerHTML=divAvance
                                                document.getElementById('reste').innerHTML=divReste
                                                // document.getElementById('avance').innerHTML='Avance : '+searchPanier.avance
                                                // document.getElementById('reste').innerHTML='Reste : '+parseInt(searchPanier.apayerPagnet-searchPanier.avance)
                                                // var idCompte2=localStorage.getItem('idCompte2')
                                                // var searchCompte=lesComptes.find(c =>c.idCompte==idCompte2);
                                                
                                                // document.getElementById('compte2').innerHTML='Compte avance : '+searchCompte.nomCompte
                                            }
                                            else{
                                                
                                                document.getElementById('avance').innerHTML='Avance : '+searchPanier.avance
                                                document.getElementById('reste').innerHTML='Reste : '+parseInt(searchPanier.apayerPagnet-searchPanier.avance)
                                                var idCompte2=localStorage.getItem('idCompte2')
                                                var searchCompte=lesComptes.find(c =>c.idCompte==idCompte2);
                                                
                                                document.getElementById('compte2').innerHTML='Compte avance : '+searchCompte.nomCompte
                                                
                                                
                                            }
                                        }
                                    }
                                }

                            }
                            else{
                                
                                var p= '<div class="panel panel-success" id=panelPanier'+lesPaniers[i].idPagnet+'>'+

                                '<div class="panel-heading">'+

                                    '<h4 data-toggle="collapse" data-parent="#accordion" href="#pagnet'+lesPaniers[i].idPagnet+'"  class="panel-title expand">'+

                                        '<div class="right-arrow pull-right">+</div>'+

                                        '<a class="row" href="#">'+ 

                                            '<span class="noImpr col-md-2 col-sm-2 col-xs-12" id=paniertermine'+lesPaniers[i].idPagnet+'> Panier '+(i+1)+'</span>'+

                                            '<span class="noImpr col-md-1 col-sm-2 col-xs-12">'+lesPaniers[i].heurePagnet+'</span>'+

                                            '<span class="noImpr col-md-2 col-sm-2 col-xs-12" >Total panier: <span id=somme_Total'+lesPaniers[i].idPagnet+' >'+lesPaniers[i].totalp+'</span></span>'+

                                            '<span class="noImpr col-md-2 col-sm-3 col-xs-12" >Total A  payer: <span id=somme_Apayer'+lesPaniers[i].idPagnet+' >'+lesPaniers[i].apayerPagnet+'</span></span>'+ 

                                            '<span class="noImpr col-md-2 col-sm-3 col-xs-12" > Facture : #'+(i+1)+'</span>'+

                                            '<span class="noImpr col-md-2 col-sm-3 col-xs-12">'+prenom.toUpperCase()+'</span>'+                

                                        '</a>'+

                                    '</h4>'+

                                '</div>'+
                                '<div id=pagnet'+lesPaniers[i].idPagnet+' class="panel-collapse collapse" > '+

                                    '<div class="panel-body" >'+

                                //<!--*******************************Debut Retourner Pagnet****************************************-->'+

                                '<button type="submit" 	 class="btn btn-danger pull-right" data-toggle="modal" data-target=#msg_rtrn_pagnet'+lesPaniers[i].idPagnet+'>'+

                                        '<span class="glyphicon glyphicon-remove"></span>Retourner'+

                                '</button >'+



                                '<div class="modal fade" id="msg_rtrn_pagnet'+lesPaniers[i].idPagnet+'" role="dialog">'+

                                    '<div class="modal-dialog">'+


                                        '<div class="modal-content">'+

                                            '<div class="modal-header panel-primary">'+

                                                '<button type="button" class="close" data-dismiss="modal">&times;</button >'+

                                                '<h4 class="modal-title">Confirmation</h4>'+

                                            '</div>'+

                                            '<form  class="form-inline noImpr"  id="factForm" method="post"  >'+

                                                '<div class="modal-body">'+

                                                    '<p>Voulez-vous retourner le panier numéro <b>'+lesPaniers[i].idPagnet+'"<b></p>'+

                                                    '<input type="hidden" name="idPagnet" id="idPagnet"  value='+lesPaniers[i].idPagnet+'>'+

                                                '</div>'+

                                                '<div class="modal-footer">'+

                                                    '<button type="button" class="btn btn-default" data-dismiss="modal">Close</button >'+

                                                    '<button type="button" name="btnRetournerPagnet" data-idPanier='+lesPaniers[i].idPagnet+' class="btn btn-success btnRetournerPagnet">Confirmer<img src="images/loading-gif3.gif" class="img-load-retournerPanier" style="height: 30px;width: 30px; display:none;" alt="GIF" srcset=""></button >'+

                                                '</div>'+

                                            '</form>'+

                                        '</div>'+

                                    '</div>'+

                                '</div>'+

                                //<!--*******************************Fin Retourner Pagnet****************************************-->'+



                                //<!--*******************************Debut Editer Pagnet****************************************-->'+


                                '<button type="button" class="btn btn-primary pull-left modeEditionBtn" id="edit-'+lesPaniers[i].idPagnet+'">'+

                                    '<span class="glyphicon glyphicon-edit"></span> Editer<img src="images/loading-gif3.gif" class="img-load-editer" style="height: 30px;width: 30px;display:none;" alt="GIF" srcset="">'+

                                '</button >'+



                                '<div class="modal fade" id="msg_edit_pagnet'+lesPaniers[i].idPagnet+'" role="dialog">'+

                                    '<div class="modal-dialog">'+

                                        '<div class="modal-content">'+

                                            '<div class="modal-header panel-primary">'+

                                                '<button type="button" class="close" data-dismiss="modal">&times;</button >'+

                                                '<h4 class="modal-title">Alert</h4>'+

                                            '</div>'+

                                            '<p>Une erreur est survenu lors de l\'édition. <br>'+

                                                'Veuillez ressayer!</p>'+

                                        '</div>'+

                                    '</div>'+

                                '</div>'+


                                //<!--*******************************Fin Editer Pagnet****************************************-->'+



                                //<!--*******************************Debut Facture****************************************-->'+




                                    '<button type="submit" class="btn btn-warning pull-right" style="margin-right:20px;" data-toggle="modal" data-target=#msg_fact_pagnet'+lesPaniers[i].idPagnet+'>'+

                                        'Facture'+

                                    '</button >'+






                                '<div class="modal fade" id="msg_fact_pagnet'+lesPaniers[i].idPagnet+'" role="dialog">'+

                                    '<div class="modal-dialog">'+

                                        //<!-- Modal content-->'+

                                        '<div class="modal-content">'+

                                            '<div class="modal-header panel-primary">'+

                                                '<button type="button" class="close" data-dismiss="modal">&times;</button >'+

                                                '<h4 class="modal-title">Informations Client</h4>'+

                                            '</div>'+

                                            '<form  class=" noImpr"  method="post"  id="idPanierFac'+lesPaniers[i].idPagnet+'"  value="'+lesPaniers[i].idPagnet+'" >'+

                                                    '<div class="modal-body">'+

                                                        '<div class="form-group">'+

                                                            '<label for="inputEmail3" class="control-label">Nom Complet </label>'+

                                                            '<input type="text" class="form-control" name="entreprise" id="nomclient'+lesPaniers[i].idPagnet+'" required="" placeholder="Le nom complet ici...">'+

                                                        '</div>'+

                                                        '<div class="row">'+

                                                            '<div class="col-xs-6">'+

                                                                '<label for="reference">Adresse Client</label>'+

                                                                '<input type="text" class="form-control" name="adresse" id="adresseclient'+lesPaniers[i].idPagnet+'">'+

                                                            '</div>'+

                                                            '<div class="col-xs-6">'+

                                                                '<label for="reference">Telephone Client</label>'+

                                                                '<input type="text" class="form-control" name="telephone" id="telephone'+lesPaniers[i].idPagnet+'" >'+

                                                            '</div>'+

                                                        '</div>'+

                                                        '<input type="hidden" name="idPagnet" id="idPanierF" value="'+lesPaniers[i].idPagnet+'">'+

                                                    '</div>'+

                                                    '<div class="modal-footer">'+

                                                        '<button type="button" class="btn btn-default" data-dismiss="modal">Close</button >'+

                                                        '<button type="submit" name="btnFacture" class="btn btn-success"'+
                                                        'onclick="imprimerFacture('+lesPaniers[i].idPagnet+')">Confirmer</button >'+

                                                    '</div>'+

                                                '</form>'+

                                        '</div>'+

                                    '</div>'+

                                '</div>'+

                                //<!--*******************************Fin Facture****************************************-->'+




                                '<button  class="btn btn-info  pull-right" style="margin-right:20px;" onclick="imprimerTicket('+lesPaniers[i].idPagnet+')">'+

                                    'Ticket de Caisse'+

                                '</button >'+






                                '<form  class="form-inline pull-right noImpr" id="ticket'+lesPaniers[i].idPagnet+'"  target="_blank" style="margin-right:20px;"'+

                                'method="post" action="ticketCaisse.html" >'+

                                '<input type="hidden" name="idPagnet" id="idPagnet"  value='+lesPaniers[i].idPagnet+' >'+

                                '</form>'+


                                        '<table  id=tablePanier'+lesPaniers[i].idPagnet+' class="tabPanier table"  width="100%" >'+

                                            '<thead>'+

                                                '<tr>'+

                                                    '<th>Référence</th>'+

                                                    '<th>Quantité</th>'+

                                                    '<th>Unité Vente</th>'+

                                                    '<th>Prix Unité Vente</th>'+

                                                '</tr>'+

                                            '</thead>'+

                                            '<tbody>'+
                                            
                                                

                                                
                                            '</tbody>'+

                                        '</table>'+
                                        '<div>'+

                                        '<div>********************************************* <br/>TOTAL : '+lesPaniers[i].totalp+'</div>'+

                                        '<div id="remise"></div>'+

                                        '<div id="apayer"><b>Net A  payer : '+lesPaniers[i].apayerPagnet+'</b></div>'+

                                        '<div id="compte"></div>'+

                                        '<div id="espece"></div>'+

                                        '<div id="rendu"></div>'+

                                        '<div id="avance"></div>'+

                                        '<div id="reste"></div>'+

                                        '<div id="compte2"></div>'+

                                        '</div>'+

                                    '</div>'+

                                    '</div>'+
                                '</div>';


                                $("#accordion").prepend(p); 
                                var lignes=JSON.parse(localStorage.getItem("ligne"));
                                if(lignes!=null){
                                for(var j=0; j<lignes.length; j++){
                                    if(lesPaniers[i].idPagnet==lignes[j].idPagnet){
                                        var l="<tr>" +

                                                    "<td>" + lignes[j].designation + "</td>" +

                                                    "<td>"+lignes[j].quantite+"</td>" +

                                                    "<td>"+lignes[j].unitevente+"</td>" +

                                                    "<td>"+lignes[j].prixunitevente +"</td>" +
                                                
                                                    '<td>'+

                                                        '<button  type="submit" 	 class="btn btn-danger pull-right" data-toggle="modal" data-target="#msg_rtrnApres_ligne'+lignes[j].numligne+'">'+

                                                                '<span class="glyphicon glyphicon-remove"></span>Retour'+

                                                        '</button>'+



                                                        '<div class="modal fade" id="msg_rtrnApres_ligne'+lignes[j].numligne+'" role="dialog">'+

                                                            '<div class="modal-dialog">'+

                                                                //<!-- Modal content-->'+

                                                                '<div class="modal-content">'+

                                                                    '<div class="modal-header panel-primary">'+

                                                                        '<button type="button" class="close" data-dismiss="modal">&times;</button>'+

                                                                        '<h4 class="modal-title">Confirmation</h4>'+

                                                                    '</div>'+

                                                                    '<form class="form-inline noImpr" id="factForm" method="post" >'+

                                                                        '<div class="modal-body">'+

                                                                            '<p>Voulez-vous retourner cette ligne du panier numéro <b>'+idPanier+'</b></p>'+

                                                                            // '<input type="hidden" name="idPagnet" id="idPagnet2618" value=1725 >'+

                                                                            // '<input type="hidden" name="designation" id="designation2618" value=Farine de niebe >'+

                                                                            // '<input type="hidden" name="numligne" id="numligne2618" value=2618 >'+

                                                                            // '<input type="hidden" name="idStock" id="idStock2618" value=0 >'+

                                                                            // '<input type="hidden" name="unitevente" id="unitevente2618" value=article >'+

                                                                            // '<input type="hidden" name="prixunitevente" id="prixunitevente2618" value=750 >'+

                                                                            // '<input type="hidden" name="prixtotal" id="prixtotal2618" value=750 >'+

                                                                            // '<input type="hidden" name="totalp" id="totalp2618" value=750 >'+

                                                                            '<div class="row">'+

                                                                                '<div class="col-xs-6">'+

                                                                                    '<label for="reference">Ancienne quantite </label>'+

                                                                                    '<input type="text" disabled="true" class="form-control" value=1 >'+

                                                                                '</div>'+

                                                                                '<div class="col-xs-6">'+

                                                                                    '<label for="reference">Nouvelle quantite</label>'+

                                                                                    '<input type="text" class="form-control inputRetourApres" name="quantite" data-numligne="'+lignes[j].numligne+'" id="quantite'+lignes[j].numligne+'" value=1 >'+

                                                                                '</div>'+

                                                                            '</div>'+

                                                                        '</div>'+

                                                                        '<div class="modal-footer">'+

                                                                            '<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>'+

                                                                            '<button type="button"  name="btnRetourApres" data-numligne="'+lignes[j].numligne+'" class="btn btn-success btnRetourApres">Confirmer'+

                                                                                '<img src="images/loading-gif3.gif" class="img-load-retourApres" style="height: 30px;width: 30px; display:none;" alt="GIF" srcset=""> </button>'+

                                                                        '</div>'+

                                                                    '</form>'+

                                                                '</div>'+

                                                            '</div>'+

                                                        '</div>'+
                                                    '</td>'+


                                                "</tr>";

                                        $("#tablePanier"+lesPaniers[i].idPagnet).prepend(l);

                                        var searchPanier=lesPaniers.find(p =>p.idPagnet==lesPaniers[i].idPagnet);
                                        var lesComptes=getCompte();

                                        var searchCompte=lesComptes.find(c =>c.idCompte==lesPaniers[i].idCompte);  
                                        

                                        document.getElementById('compte').innerHTML='Compte : '+searchCompte.nomCompte

                                        if(searchPanier.remise==0){
                                            divRemise='<div></div>';
                                            document.getElementById('remise').innerHTML=divRemise
                                            //$('#remise').hide
                                            
                                        
                                        }
                                        else{
                                            document.getElementById('remise').innerHTML='Remise : '+searchPanier.remise
                                        }
                                        if(searchPanier.versement==0){
                                            divEspece='<div></div>';
                                            divRendu='<div></div>';
                                            document.getElementById('espece').innerHTML=divEspece
                                            document.getElementById('rendu').innerHTML=divRendu
                                            // $('#espece').hide
                                            // $('#rendu').hide
                                        }
                                        else{

                                            document.getElementById('espece').innerHTML='Espèce : '+searchPanier.versement
                                            document.getElementById('rendu').innerHTML='Rendu : '+searchPanier.restourne
                                        }
                                        if(searchPanier.avance==0 || searchPanier.avance==""){
                                            divAvance='<div></div>';
                                            divReste='<div></div>';
                                            document.getElementById('avance').innerHTML=divAvance
                                            document.getElementById('reste').innerHTML=divReste
                                            
                                        }
                                        else{
                                            
                                            document.getElementById('avance').innerHTML='Avance : '+searchPanier.avance
                                            document.getElementById('reste').innerHTML='Reste : '+parseInt(searchPanier.apayerPagnet-searchPanier.avance)
                                            var idCompte2=localStorage.getItem('idCompte2')
                                            var searchCompte=lesComptes.find(c =>c.idCompte==idCompte2);
                                            
                                            document.getElementById('compte2').innerHTML='Compte avance : '+searchCompte.nomCompte
                                            
                                            
                                        }
                                    }
                                }

                                
                                }
                            }

                        }
                        
                    }   
                    } 
            
                for(var j=lesPaniers.length-10; j<lesPaniers.length;j++){
                    
                    if(lesPaniers[j].verrouiller==0 && lesPaniers[j].iduser==sessionStorage.iduserSession){
                        var p= '<div class="panel panel-primary" id=panelPanier'+lesPaniers[j].idPagnet+'>'+

                            '<div class="panel-heading">'+

                                '<h4 data-toggle="collapse" data-parent="#accordion" href="#pagnet'+lesPaniers[j].idPagnet+'"  class="panel-title expand">'+

                                    '<div class="right-arrow pull-right">+</div>'+

                                    '<a class="row" href="#">'+ 

                                        '<span class="noImpr col-md-2 col-sm-2 col-xs-12" id="panierEncours'+lesPaniers[j].idPagnet+'"> Panier : En cours... </span>'+

                                        '<span class="noImpr col-md-3 col-sm-3 col-xs-12">Heure: '+lesPaniers[j].heurePagnet+'</span>'+

                                        '<span class="noImpr col-md-3 col-sm-3 col-xs-12" >Total panier: <span id="somme_Total'+lesPaniers[j].idPagnet+'" > '+somme_A_payer()+' </span></span>'+

                                        '<span class="noImpr col-md-3 col-sm-3 col-xs-12" >Total A  payer: <span id="somme_Apayer'+lesPaniers[j].idPagnet+'" >'+somme_A_payer()+'</span></span>'+                 

                                    '</a>'+

                                '</h4>'+

                            '</div>'+
                            '<div id="pagnet'+lesPaniers[j].idPagnet+'" class="panel-collapse collapse in panelVente" > '+

                                '<div class="panel-body" >'+

                                    '<div class="cache_btn_Terminer row" id="cache_btn_Terminer'+lesPaniers[j].idPagnet+'">'+

                                        //<!--*******************************Debut Ajouter Ligne****************************************-->

                                            '<form  class="form-inline noImpr ajouterProdForm col-md-4 col-sm-4 col-xs-12" id="ajouterProdFormB'+lesPaniers[j].idPagnet+'" onsubmit="return false" >'+

                                                '<input type="text" class="inputbasic form-control codeBarreLigneVt" name="codeBarre" id="panier_'+lesPaniers[j].idPagnet+'" data-idPanier='+lesPaniers[j].idPagnet+' style="width:100%;" autofocus="" autocomplete="off"  required />'+

                                                '<input type="hidden" name="idPagnet" id="idPagnet" value='+lesPaniers[j].idPagnet+'>'+

                                            '</form>'+

                                        //<!--*******************************Fin Ajouter Ligne****************************************-->

                                        '<div class="col-md-8 col-sm-8 col-xs-12 content2">'+

                                            //<!--*******************************Debut Terminer Pagnet****************************************-->

                                            '<form class="form-inline noImpr" id="factForm" method="post">'+
                                                //'<div id="compte_caisse'+lesPaniers[j].idPagnet+'">'+
                                                    '<input type="number" id="val_remise1'+lesPaniers[j].idPagnet+'" name="remise"  class="remise form-control col-md-2 col-sm-2 col-xs-3" placeholder="Remise....">'+

                                                    
                                                    '<select class="compte '+lesPaniers[j].idPagnet+' form-control col-md-2 col-sm-2 col-xs-3"  data-idPanier='+lesPaniers[j].idPagnet+' name="compte'+lesPaniers[j].idPagnet+'"  id="compteCaisse'+lesPaniers[j].idPagnet+'">'+
                                                    
                                                    '</select>'+

                                                    '<input type="number" name="versement" id="versement'+lesPaniers[j].idPagnet+'" onkeyup="modif_Versement(this.value, '+lesPaniers[j].idPagnet+')"  placeholder="Espèce..."'+
                                                    'class="versement form-control col-md-2 col-sm-2 col-xs-3" >'+
                                                    '<input type="text" class="client clientInput form-control col-md-2 col-sm-2 col-xs-3"  data-type="simple" data-idPanier="'+lesPaniers[j].idPagnet+'" name="clientInput" id="clientInput'+lesPaniers[j].idPagnet+'" autocomplete="off" placeholder="Client"/>'+

                                                    '<input type="number" class="avanceInput form-control col-md-2 col-sm-2 col-xs-3"  data-idPanier="'+lesPaniers[j].idPagnet+'" name="avanceInput" id="avanceInput'+lesPaniers[j].idPagnet+'" autocomplete="off" placeholder="Avance"/>'+

                                                    '<select class="compte  form-control col-md-2 col-sm-2 col-xs-3"   name="compte"  id="compteBon'+lesPaniers[j].idPagnet+'">'+
                                                        
                                                    '</select>'+    
                                                //'</div>'+

                                                // '<div id="compte_bon'+lesPaniers[j].idPagnet+'">'+

                                                //     '<input type="number" id="val_remise2'+lesPaniers[j].idPagnet+'" name="remise"  class="remise form-control col-md-2 col-sm-2 col-xs-3" placeholder="Remise....">'+
                                    
                                                //     '<select class="compte  form-control col-md-2 col-sm-2 col-xs-3"   name="compte"  id="compteBon'+lesPaniers[j].idPagnet+'" onChange="change1(this.value);">'+
                                                        
                                                //     '</select>'+

                                                //     '<input type="text" class="client clientInput form-control col-md-2 col-sm-2 col-xs-3"  data-type="simple" data-idPanier="'+lesPaniers[j].idPagnet+'" name="clientInput" id="clientInput'+lesPaniers[j].idPagnet+'" autocomplete="off" placeholder="Client"/>'+

                                                //     '<input type="number" class="avanceInput form-control col-md-2 col-sm-2 col-xs-3"  data-idPanier="'+lesPaniers[j].idPagnet+'" name="avanceInput" id="avanceInput'+lesPaniers[j].idPagnet+'" autocomplete="off" placeholder="Avance"/>'+

                                                //     '<select class="compteAvance 1751 form-control col-md-2 col-sm-2 col-xs-3"  data-idPanier="'+lesPaniers[j].idPagnet+'" name="compteAvance"  id="compteBon1'+lesPaniers[j].idPagnet+'">'+

                                                //     '</select>'+ 
                                                    
                                                // '</div>'+
                                                
                                                

                                                
                                                

                                                '<input type="hidden" name="idPagnet"   value='+lesPaniers[j].idPagnet+'>'+

                                                '<input type="hidden" name="totalp" id=totalp'+lesPaniers[j].idPagnet+' value="0" >'+

                                                '<button type="button" style="" name="btnImprimerFacture" data-idPanier='+lesPaniers[j].idPagnet+' id=btnImprimerFacture'+lesPaniers[j].idPagnet+' class="btn btn-success btn_Termine_Panier btn_Termine_Panier'+lesPaniers[j].idPagnet+' terminer" data-toggle="modal" ><span class="glyphicon glyphicon-ok"></span>'+

                                                    '<img src="images/loading-gif3.gif" class="img-load-terminer" style="height: 30px;width: 30px;display:none;" alt="GIF" srcset=""></button>'+

                                                '<button tabindex="1" type="button" class="btn btn-danger annuler" data-toggle="modal" data-target=#msg_ann_pagnet'+lesPaniers[j].idPagnet+'>'+

                                                    '<span class="glyphicon glyphicon-remove"></span>'+

                                                '</button>'+

                                            '</form>'+

                                            //<!--*******************************Fin Terminer Pagnet****************************************-->          

                                            //<!--*******************************Debut Annuler Pagnet****************************************-->


                                            '<div class="modal fade" id="msg_ann_pagnet'+lesPaniers[j].idPagnet+'" role="dialog">'+

                                                '<div class="modal-dialog">'+

                                                    //<!-- Modal content-->

                                                    '<div class="modal-content">'+

                                                        '<div class="modal-header panel-primary">'+

                                                            '<button type="button" class="close" data-dismiss="modal">&times;</button>'+

                                                            '<h4 class="modal-title">Confirmation</h4>'+

                                                        '</div>'+

                                                        '<form class="form-inline noImpr"  id="factForm" method="post"  >'+

                                                            '<div class="modal-body">'+

                                                                '<p>Voulez-vous annuler le panier numéro <b>'+lesPaniers[j].idPagnet+'</b></p>'+

                                                                '<input type="hidden" name="idPagnet" id="idPagnet"  value='+lesPaniers[j].idPagnet+'>'+

                                                            '</div>'+

                                                            '<div class="modal-footer">'+

                                                                '<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>'+

                                                                '<button type="button" name="btnAnnulerPagnet" data-idPanier='+lesPaniers[j].idPagnet+' class="btn btn-success btnAnnulerPagnet">Confirmer<img src="images/loading-gif3.gif" class="img-load-annulerPanier" style="height: 30px;width: 30px; display:none;" alt="GIF" srcset=""></button>'+

                                                            '</div>'+

                                                        '</form>'+

                                                    '</div>'+

                                                '</div>'+

                                            '</div>'+

                                            //<!--*******************************Fin Annuler Pagnet****************************************-->

                                        '</div>'+  

                                    '</div>'+

                                    '<table  id=tablePanier'+lesPaniers[j].idPagnet+' class="tabPanier table"  width="100%" >'+

                                        '<thead>'+

                                            '<tr>'+

                                                '<th>Référence</th>'+

                                                '<th>Quantité</th>'+

                                                '<th>Unité Vente</th>'+

                                                //<!-- <th class="hidden-sm hidden-xs">Unitévente</th>'+ -->

                                                '<th>Prix Unité Vente</th>'+

                                            '</tr>'+

                                        '</thead>'+

                                        '<tbody>'+
                                        
                                            

                                            
                                        '</tbody>'+

                                    '</table>'+

                                '</div>'+

                                '</div>'+
                            '</div>';

                        $("#accordion").prepend(p);

                        var lignes=JSON.parse(localStorage.getItem("ligne"));
                        
                        if(lignes!=null){
                            for(var i=0; i<lignes.length; i++){
                                if(lesPaniers[j].idPagnet==lignes[i].idPagnet){
                                    designations=getDesignation()
                                    searchDesignation=designations.find(d =>d.idDesignation==lignes[i].idDesignation); 
                                    
                                    nbreArticleUniteStok=searchDesignation.nbreArticleUniteStock

                                    //alert(nbreArticleUniteStok)
                                    if(lignes[i].unitevente!='Article' && lignes[i].unitevente!='article'){

                                        var l='<tr>' +

                                            '<td>' + lignes[i].designation + '</td>' +

                                            '<td><input class="form-control filedReadonly'+lignes[i].idPagnet+'" id="ligneQuantite'+lignes[i].idPagnet+' '+lignes[i].designation+' " onkeyup="modif_Quantite(this.value,'+lignes[i].numligne+')" value="' + lignes[i].quantite + '" style="width: 30%" type="number" ></input></td>' +
                                            //'<input type="text" id="nbreArticleUniteStock1" value="'+nbreArticleUniteStok+'"/>'+
                                            '<td>' +

                                                '<select class="form-control filedReadonly'+lignes[i].idPagnet+' " id="uniteVente'+lignes[i].unitevente+' " onchange="modif_UniteStock(this.value,'+lignes[i].numligne+', '+nbreArticleUniteStok+', '+lignes[i].idPagnet+')" >' +

                                                        '<option id="default" value="Caisse" >Caisse</option>'+

                                                        '<option  value="Article">Article</option>'+

                                                '</select>'+

                                            '</td>' +

                                            '<td><input  class="form-control" id="prixUniteStock'+lignes[i].idPagnet+''+lignes[i].designation+' " onkeyup="modif_Prix(this.value,'+lignes[i].numligne+')" value="' + (lignes[i].prixunitevente)*nbreArticleUniteStok + '" style="width: 70%" type="number"></input></td>' +


                                            '<td>'+

                                                '<button type="submit" 	 class="btn btn-warning pull-right btn_Retourner_Produit btn_Retourner_Produit'+lignes[i].idPagnet+'" data-toggle="modal" data-target="#msg_rtrnAvant_ligne'+lignes[i].numligne+'">'+

                                                        '<span class="glyphicon glyphicon-remove"></span>Retour'+

                                                '</button>'+

                                                '<div class="modal fade" id="msg_rtrnAvant_ligne'+lignes[i].numligne+'" role="dialog">'+

                                                    '<div class="modal-dialog">'+

                                                        //<!-- Modal content-->

                                                        '<div class="modal-content">'+

                                                            '<div class="modal-header panel-primary">'+

                                                                '<button type="button" class="close" data-dismiss="modal">&times;</button>'+

                                                                '<h4 class="modal-title">Confirmation</h4>'+

                                                            '</div>'+

                                                            '<form class="form-inline noImpr" id="factForm" method="post">'+

                                                                '<div class="modal-body">'+

                                                                    '<p>Voulez-vous annuler cette ligne du panier numéro <b>'+lignes[i].numligne+'</b></p>'+


                                                                '</div>'+

                                                                '<div class="modal-footer">'+

                                                                    '<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>'+

                                                                    '<button type="button" name="btnRetourAvant" data-numligne="'+lignes[i].numligne+'" class="btn btn-success btnRetourAvant">Confirmer</button>'+

                                                                '</div>'+

                                                            '</form>'+

                                                        '</div>'+

                                                    '</div>'+

                                                '</div>'+

                                                '</td>'+

                                            '</tr>';

                                            $("#tablePanier"+lesPaniers[j].idPagnet).prepend(l);

                                    }
                                    else{
                                        var l='<tr>' +

                                            '<td>' + lignes[i].designation + '</td>' +

                                            '<td><input class="form-control filedReadonly'+lignes[i].idPagnet+'" id="ligneQuantite'+lignes[i].idPagnet+' '+lignes[i].designation+' " onkeyup="modif_Quantite(this.value,'+lignes[i].numligne+')" value="' + lignes[i].quantite + '" style="width: 30%" type="number" ></input></td>' +
                                            //'<input type="text" id="nbreArticleUniteStock1" value="'+nbreArticleUniteStok+'"/>'+
                                            '<td>' +

                                                '<select class="form-control filedReadonly'+lignes[i].idPagnet+' " id="uniteVente'+lignes[i].unitevente+' " onchange="modif_UniteStock(this.value,'+lignes[i].numligne+', '+nbreArticleUniteStok+', '+lignes[i].idPagnet+')" >' +

                                                    '<option id="default" value="Article" >Article</option>'+

                                                    '<option  value="Caisse">Caisse</option>'+

                                                '</select>'+

                                            '</td>' +

                                            '<td><input  class="form-control" id="prixUniteStock'+lignes[i].idPagnet+''+lignes[i].designation+' " onkeyup="modif_Prix(this.value,'+lignes[i].numligne+')" value="' + lignes[i].prixunitevente + '" style="width: 70%" type="number"></input></td>' +


                                            '<td>'+

                                                '<button type="submit" 	 class="btn btn-warning pull-right btn_Retourner_Produit btn_Retourner_Produit'+lignes[i].idPagnet+'" data-toggle="modal" data-target="#msg_rtrnAvant_ligne'+lignes[i].numligne+'">'+

                                                        '<span class="glyphicon glyphicon-remove"></span>Retour'+

                                                '</button>'+

                                                '<div class="modal fade" id="msg_rtrnAvant_ligne'+lignes[i].numligne+'" role="dialog">'+

                                                    '<div class="modal-dialog">'+

                                                        //<!-- Modal content-->

                                                        '<div class="modal-content">'+

                                                            '<div class="modal-header panel-primary">'+

                                                                '<button type="button" class="close" data-dismiss="modal">&times;</button>'+

                                                                '<h4 class="modal-title">Confirmation</h4>'+

                                                            '</div>'+

                                                            '<form class="form-inline noImpr" id="factForm" method="post">'+

                                                                '<div class="modal-body">'+

                                                                    '<p>Voulez-vous annuler cette ligne du panier numéro <b>'+lignes[i].numligne+'</b></p>'+


                                                                '</div>'+

                                                                '<div class="modal-footer">'+

                                                                    '<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>'+

                                                                    '<button type="button" name="btnRetourAvant" data-numligne="'+lignes[i].numligne+'" class="btn btn-success btnRetourAvant">Confirmer</button>'+

                                                                '</div>'+

                                                            '</form>'+

                                                        '</div>'+

                                                    '</div>'+

                                                '</div>'+

                                                '</td>'+

                                            '</tr>';

                                            $("#tablePanier"+lesPaniers[j].idPagnet).prepend(l);

                                    }
                                    
                                    
                                    
                                }
                            }
                        }
                        
                    }  
                    
                }
            
            }
            else{
                for(var i=0; i<lesPaniers.length;i++){
                    //var val=parseInt(lesPaniers[i].idPagnet);
                    //users= paniers.filter(p =>p.datepagej==datejour)
                    //var numPanier=val+1
                    if(lesPaniers[i].verrouiller==1 && lesPaniers[i].iduser==sessionStorage.iduserSession){
                        
                        //paniers= lesPaniers.filter(p =>p.datepagej==datejour);
                        var numPanier=0
                        // for(var j=0; j<paniers.length;j++){
                        //     numPanier=j+1
                        
                        // var numPanier=0
                        //numPanier=i+1
                        if(lesPaniers[i].type==30){
                            if(lesPaniers[i].synchronise==0){
                                var p= '<div class="panel panel-warnig" id=panelPanier'+lesPaniers[i].idPagnet+'>'+

                                '<div class="panel-heading">'+

                                    '<h4 data-toggle="collapse" data-parent="#accordion" href="#pagnet'+lesPaniers[i].idPagnet+'"  class="panel-title expand">'+

                                        '<div class="right-arrow pull-right">+</div>'+

                                        '<a class="row" href="#">'+ 

                                            '<span class="noImpr col-md-2 col-sm-2 col-xs-12" id=paniertermine'+lesPaniers[i].idPagnet+'> Panier '+(i+1)+'</span>'+

                                            '<span class="noImpr col-md-1 col-sm-2 col-xs-12">'+lesPaniers[i].heurePagnet+'</span>'+

                                            '<span class="noImpr col-md-2 col-sm-2 col-xs-12" >Total panier: <span id=somme_Total'+lesPaniers[i].idPagnet+' >'+lesPaniers[i].totalp+'</span></span>'+

                                            '<span class="noImpr col-md-2 col-sm-3 col-xs-12" >Total A  payer: <span id=somme_Apayer'+lesPaniers[i].idPagnet+' >'+lesPaniers[i].apayerPagnet+'</span></span>'+ 

                                            '<span class="noImpr col-md-2 col-sm-3 col-xs-12" > Facture : #'+(i+1)+'</span>'+

                                            '<span class="noImpr col-md-2 col-sm-3 col-xs-12"> '+prenom.toUpperCase()+'</span>'+                

                                        '</a>'+

                                    '</h4>'+

                                '</div>'+
                                '<div id=pagnet'+lesPaniers[i].idPagnet+' class="panel-collapse collapse" > '+

                                    '<div class="panel-body" >'+

                                //<!--*******************************Debut Retourner Pagnet****************************************-->'+

                                '<button type="submit" 	 class="btn btn-danger pull-right" data-toggle="modal" data-target=#msg_rtrn_pagnet'+lesPaniers[i].idPagnet+'>'+

                                        '<span class="glyphicon glyphicon-remove"></span>Retourner'+

                                '</button >'+



                                '<div class="modal fade" id="msg_rtrn_pagnet'+lesPaniers[i].idPagnet+'" role="dialog">'+

                                    '<div class="modal-dialog">'+


                                        '<div class="modal-content">'+

                                            '<div class="modal-header panel-primary">'+

                                                '<button type="button" class="close" data-dismiss="modal">&times;</button >'+

                                                '<h4 class="modal-title">Confirmation</h4>'+

                                            '</div>'+

                                            '<form  class="form-inline noImpr"  id="factForm" method="post"  >'+

                                                '<div class="modal-body">'+

                                                    '<p>Voulez-vous retourner le panier numéro <b>'+lesPaniers[i].idPagnet+'"<b></p>'+

                                                    '<input type="hidden" name="idPagnet" id="idPagnet"  value='+lesPaniers[i].idPagnet+'>'+

                                                '</div>'+

                                                '<div class="modal-footer">'+

                                                    '<button type="button" class="btn btn-default" data-dismiss="modal">Close</button >'+

                                                    '<button type="button" name="btnRetournerPagnet" data-idPanier='+lesPaniers[i].idPagnet+' class="btn btn-success btnRetournerPagnet">Confirmer<img src="images/loading-gif3.gif" class="img-load-retournerPanier" style="height: 30px;width: 30px; display:none;" alt="GIF" srcset=""></button >'+

                                                '</div>'+

                                            '</form>'+

                                        '</div>'+

                                    '</div>'+

                                '</div>'+

                                //<!--*******************************Fin Retourner Pagnet****************************************-->'+



                                //<!--*******************************Debut Editer Pagnet****************************************-->'+


                                '<button type="button" class="btn btn-primary pull-left modeEditionBtn" id="edit-'+lesPaniers[i].idPagnet+'">'+

                                    '<span class="glyphicon glyphicon-edit"></span> Editer<img src="images/loading-gif3.gif" class="img-load-editer" style="height: 30px;width: 30px;display:none;" alt="GIF" srcset="">'+

                                '</button >'+



                                '<div class="modal fade" id="msg_edit_pagnet'+lesPaniers[i].idPagnet+'" role="dialog">'+

                                    '<div class="modal-dialog">'+

                                        '<div class="modal-content">'+

                                            '<div class="modal-header panel-primary">'+

                                                '<button type="button" class="close" data-dismiss="modal">&times;</button >'+

                                                '<h4 class="modal-title">Alert</h4>'+

                                            '</div>'+

                                            '<p>Une erreur est survenu lors de l\'édition. <br>'+

                                                'Veuillez ressayer!</p>'+

                                        '</div>'+

                                    '</div>'+

                                '</div>'+


                                //<!--*******************************Fin Editer Pagnet****************************************-->'+



                                //<!--*******************************Debut Facture****************************************-->'+




                                    '<button type="submit" class="btn btn-warning pull-right" style="margin-right:20px;" data-toggle="modal" data-target=#msg_fact_pagnet'+lesPaniers[i].idPagnet+'>'+

                                        'Facture'+

                                    '</button >'+






                                '<div class="modal fade" id="msg_fact_pagnet'+lesPaniers[i].idPagnet+'" role="dialog">'+

                                    '<div class="modal-dialog">'+

                                        //<!-- Modal content-->'+

                                        '<div class="modal-content">'+

                                            '<div class="modal-header panel-primary">'+

                                                '<button type="button" class="close" data-dismiss="modal">&times;</button >'+

                                                '<h4 class="modal-title">Informations Client</h4>'+

                                            '</div>'+

                                            '<form  class=" noImpr"  method="post"  id="idPanierFac'+lesPaniers[i].idPagnet+'"  value="'+lesPaniers[i].idPagnet+'" >'+

                                                    '<div class="modal-body">'+

                                                        '<div class="form-group">'+

                                                            '<label for="inputEmail3" class="control-label">Nom Complet </label>'+

                                                            '<input type="text" class="form-control" name="entreprise" id="nomclient'+lesPaniers[i].idPagnet+'" required="" placeholder="Le nom complet ici...">'+

                                                        '</div>'+

                                                        '<div class="row">'+

                                                            '<div class="col-xs-6">'+

                                                                '<label for="reference">Adresse Client</label>'+

                                                                '<input type="text" class="form-control" name="adresse" id="adresseclient'+lesPaniers[i].idPagnet+'">'+

                                                            '</div>'+

                                                            '<div class="col-xs-6">'+

                                                                '<label for="reference">Telephone Client</label>'+

                                                                '<input type="text" class="form-control" name="telephone" id="telephone'+lesPaniers[i].idPagnet+'" >'+

                                                            '</div>'+

                                                        '</div>'+

                                                        '<input type="hidden" name="idPagnet" id="idPanierF" value="'+lesPaniers[i].idPagnet+'">'+

                                                    '</div>'+

                                                    '<div class="modal-footer">'+

                                                        '<button type="button" class="btn btn-default" data-dismiss="modal">Close</button >'+

                                                        '<button type="submit" name="btnFacture" class="btn btn-success"'+
                                                        'onclick="imprimerFacture('+lesPaniers[i].idPagnet+')">Confirmer</button >'+

                                                    '</div>'+

                                                '</form>'+

                                        '</div>'+

                                    '</div>'+

                                '</div>'+

                                //<!--*******************************Fin Facture****************************************-->'+




                                '<button  class="btn btn-info  pull-right" style="margin-right:20px;" onclick="imprimerTicket('+lesPaniers[i].idPagnet+')">'+

                                    'Ticket de Caisse'+

                                '</button >'+






                                '<form  class="form-inline pull-right noImpr" id="ticket'+lesPaniers[i].idPagnet+'"  target="_blank" style="margin-right:20px;"'+

                                'method="post" action="ticketCaisse.html" >'+

                                '<input type="hidden" name="idPagnet" id="idPagnet"  value='+lesPaniers[i].idPagnet+' >'+

                                '</form>'+


                                        '<table  id=tablePanier'+lesPaniers[i].idPagnet+' class="tabPanier table"  width="100%" >'+

                                            '<thead>'+

                                                '<tr>'+

                                                    '<th>Référence</th>'+

                                                    '<th>Quantité</th>'+

                                                    '<th>Unité Vente</th>'+

                                                    '<th>Prix Unité Vente</th>'+

                                                '</tr>'+

                                            '</thead>'+

                                            '<tbody>'+
                                            
                                                

                                                
                                            '</tbody>'+

                                        '</table>'+
                                        '<div>'+

                                            '<div>********************************************* <br/>TOTAL : '+lesPaniers[i].totalp+'<br/></div>'+

                                            '<div id="remise"><br/></div>'+

                                            '<div id="apayer"><b>Net A  payer : '+lesPaniers[i].apayerPagnet+'</b><br/></div>'+

                                            '<div id="compte"><br/></div>'+

                                            '<div id="espece"><br/></div>'+

                                            '<div id="rendu"><br/></div>'+

                                            '<div id="avance"><br/></div>'+

                                            '<div id="reste"><br/></div>'+

                                            '<div id="compte2"><br/></div>'+

                                        '</div>'+
                                        

                                    '</div>'+

                                    '</div>'+
                                '</div>';

                                $("#accordion").prepend(p); 
                                var lignes=JSON.parse(localStorage.getItem("ligne"));
                                if(lignes!=null){
                                for(var j=0; j<lignes.length; j++){
                                    if(lesPaniers[i].idPagnet==lignes[j].idPagnet){
                                        var l="<tr>" +

                                                    "<td>" + lignes[j].designation + "</td>" +

                                                    "<td>"+lignes[j].quantite+"</td>" +

                                                    "<td>"+lignes[j].unitevente+"</td>" +

                                                    "<td>"+lignes[j].prixunitevente +"</td>" +
                                                
                                                    '<td>'+

                                                        '<button  type="submit" 	 class="btn btn-danger pull-right" data-toggle="modal" data-target="#msg_rtrnApres_ligne'+lignes[j].numligne+'">'+

                                                                '<span class="glyphicon glyphicon-remove"></span>Retour'+

                                                        '</button>'+



                                                        '<div class="modal fade" id="msg_rtrnApres_ligne'+lignes[j].numligne+'" role="dialog">'+

                                                            '<div class="modal-dialog">'+

                                                                //<!-- Modal content-->'+

                                                                '<div class="modal-content">'+

                                                                    '<div class="modal-header panel-primary">'+

                                                                        '<button type="button" class="close" data-dismiss="modal">&times;</button>'+

                                                                        '<h4 class="modal-title">Confirmation</h4>'+

                                                                    '</div>'+

                                                                    '<form class="form-inline noImpr" id="factForm" method="post" >'+

                                                                        '<div class="modal-body">'+

                                                                            '<p>Voulez-vous retourner cette ligne du panier numéro <b>'+idPanier+'</b></p>'+

                                                                            // '<input type="hidden" name="idPagnet" id="idPagnet2618" value=1725 >'+

                                                                            // '<input type="hidden" name="designation" id="designation2618" value=Farine de niebe >'+

                                                                            // '<input type="hidden" name="numligne" id="numligne2618" value=2618 >'+

                                                                            // '<input type="hidden" name="idStock" id="idStock2618" value=0 >'+

                                                                            // '<input type="hidden" name="unitevente" id="unitevente2618" value=article >'+

                                                                            // '<input type="hidden" name="prixunitevente" id="prixunitevente2618" value=750 >'+

                                                                            // '<input type="hidden" name="prixtotal" id="prixtotal2618" value=750 >'+

                                                                            // '<input type="hidden" name="totalp" id="totalp2618" value=750 >'+

                                                                            '<div class="row">'+

                                                                                '<div class="col-xs-6">'+

                                                                                    '<label for="reference">Ancienne quantite </label>'+

                                                                                    '<input type="text" disabled="true" class="form-control" value=1 >'+

                                                                                '</div>'+

                                                                                '<div class="col-xs-6">'+

                                                                                    '<label for="reference">Nouvelle quantite</label>'+

                                                                                    '<input type="text" class="form-control inputRetourApres" name="quantite" data-numligne="'+lignes[j].numligne+'" id="quantite'+lignes[j].numligne+'" value=1 >'+

                                                                                '</div>'+

                                                                            '</div>'+

                                                                        '</div>'+

                                                                        '<div class="modal-footer">'+

                                                                            '<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>'+

                                                                            '<button type="button"  name="btnRetourApres" data-numligne="'+lignes[j].numligne+'" class="btn btn-success btnRetourApres">Confirmer'+

                                                                                '<img src="images/loading-gif3.gif" class="img-load-retourApres" style="height: 30px;width: 30px; display:none;" alt="GIF" srcset=""> </button>'+

                                                                        '</div>'+

                                                                    '</form>'+

                                                                '</div>'+

                                                            '</div>'+

                                                        '</div>'+
                                                    '</td>'+


                                                "</tr>";

                                        $("#tablePanier"+lesPaniers[i].idPagnet).prepend(l);

                                        var searchPanier=lesPaniers.find(p =>p.idPagnet==lesPaniers[i].idPagnet);
                                        var lesComptes=getCompte();

                                        var searchCompte=lesComptes.find(c =>c.idCompte==lesPaniers[i].idCompte);  
                                        

                                        document.getElementById('compte').innerHTML='Compte : '+searchCompte.nomCompte

                                        if(searchPanier.remise==0){
                                            divRemise='<div></div>';
                                            document.getElementById('remise').innerHTML=divRemise
                                            //$('#remise').hide
                                            
                                        
                                        }
                                        else{
                                            document.getElementById('remise').innerHTML='Remise : '+searchPanier.remise
                                        }
                                        if(searchPanier.versement==0){
                                            divEspece='<div></div>';
                                            divRendu='<div></div>';
                                            document.getElementById('espece').innerHTML=divEspece
                                            document.getElementById('rendu').innerHTML=divRendu
                                            // $('#espece').hide
                                            // $('#rendu').hide
                                        }
                                        else{

                                            document.getElementById('espece').innerHTML='Espèce : '+searchPanier.versement
                                            document.getElementById('rendu').innerHTML='Rendu : '+searchPanier.restourne
                                        }
                                        if(searchPanier.avance==0 || searchPanier.avance==""){
                                            divAvance='<div></div>';
                                            divReste='<div></div>';
                                            document.getElementById('avance').innerHTML=divAvance
                                            document.getElementById('reste').innerHTML=divReste
                                            
                                        }
                                        else{
                                            
                                            document.getElementById('avance').innerHTML='Avance : '+searchPanier.avance
                                            document.getElementById('reste').innerHTML='Reste : '+parseInt(searchPanier.apayerPagnet-searchPanier.avance)
                                            var idCompte2=localStorage.getItem('idCompte2')
                                            var searchCompte=lesComptes.find(c =>c.idCompte==idCompte2);
                                            
                                            document.getElementById('compte2').innerHTML='Compte avance : '+searchCompte.nomCompte
                                            
                                            
                                        }
                                    }
                                }
                            }


                        }
                            else{
                                var p= '<div class="panel panel-info" id=panelPanier'+lesPaniers[i].idPagnet+'>'+

                                '<div class="panel-heading">'+

                                    '<h4 data-toggle="collapse" data-parent="#accordion" href="#pagnet'+lesPaniers[i].idPagnet+'"  class="panel-title expand">'+

                                        '<div class="right-arrow pull-right">+</div>'+

                                        '<a class="row" href="#">'+ 

                                            '<span class="noImpr col-md-2 col-sm-2 col-xs-12" id=paniertermine'+lesPaniers[i].idPagnet+'> Panier '+(i+1)+'</span>'+

                                            '<span class="noImpr col-md-1 col-sm-2 col-xs-12">'+lesPaniers[i].heurePagnet+'</span>'+

                                            '<span class="noImpr col-md-2 col-sm-2 col-xs-12" >Total panier: <span id=somme_Total'+lesPaniers[i].idPagnet+' >'+lesPaniers[i].totalp+'</span></span>'+

                                            '<span class="noImpr col-md-2 col-sm-3 col-xs-12" >Total A  payer: <span id=somme_Apayer'+lesPaniers[i].idPagnet+' >'+lesPaniers[i].apayerPagnet+'</span></span>'+ 

                                            '<span class="noImpr col-md-2 col-sm-3 col-xs-12" > Facture : #'+(i+1)+'</span>'+

                                            '<span class="noImpr col-md-2 col-sm-3 col-xs-12"> '+prenom.toUpperCase()+'</span>'+                

                                        '</a>'+

                                    '</h4>'+

                                '</div>'+
                                '<div id=pagnet'+lesPaniers[i].idPagnet+' class="panel-collapse collapse" > '+

                                    '<div class="panel-body" >'+

                                //<!--*******************************Debut Retourner Pagnet****************************************-->'+

                                '<button type="submit" 	 class="btn btn-danger pull-right" data-toggle="modal" data-target=#msg_rtrn_pagnet'+lesPaniers[i].idPagnet+'>'+

                                        '<span class="glyphicon glyphicon-remove"></span>Retourner'+

                                '</button >'+



                                '<div class="modal fade" id="msg_rtrn_pagnet'+lesPaniers[i].idPagnet+'" role="dialog">'+

                                    '<div class="modal-dialog">'+


                                        '<div class="modal-content">'+

                                            '<div class="modal-header panel-primary">'+

                                                '<button type="button" class="close" data-dismiss="modal">&times;</button >'+

                                                '<h4 class="modal-title">Confirmation</h4>'+

                                            '</div>'+

                                            '<form  class="form-inline noImpr"  id="factForm" method="post"  >'+

                                                '<div class="modal-body">'+

                                                    '<p>Voulez-vous retourner le panier numéro <b>'+lesPaniers[i].idPagnet+'"<b></p>'+

                                                    '<input type="hidden" name="idPagnet" id="idPagnet"  value='+lesPaniers[i].idPagnet+'>'+

                                                '</div>'+

                                                '<div class="modal-footer">'+

                                                    '<button type="button" class="btn btn-default" data-dismiss="modal">Close</button >'+

                                                    '<button type="button" name="btnRetournerPagnet" data-idPanier='+lesPaniers[i].idPagnet+' class="btn btn-success btnRetournerPagnet">Confirmer<img src="images/loading-gif3.gif" class="img-load-retournerPanier" style="height: 30px;width: 30px; display:none;" alt="GIF" srcset=""></button >'+

                                                '</div>'+

                                            '</form>'+

                                        '</div>'+

                                    '</div>'+

                                '</div>'+

                                //<!--*******************************Fin Retourner Pagnet****************************************-->'+



                                //<!--*******************************Debut Editer Pagnet****************************************-->'+


                                '<button type="button" class="btn btn-primary pull-left modeEditionBtn" id="edit-'+lesPaniers[i].idPagnet+'">'+

                                    '<span class="glyphicon glyphicon-edit"></span> Editer<img src="images/loading-gif3.gif" class="img-load-editer" style="height: 30px;width: 30px;display:none;" alt="GIF" srcset="">'+

                                '</button >'+



                                '<div class="modal fade" id="msg_edit_pagnet'+lesPaniers[i].idPagnet+'" role="dialog">'+

                                    '<div class="modal-dialog">'+

                                        '<div class="modal-content">'+

                                            '<div class="modal-header panel-primary">'+

                                                '<button type="button" class="close" data-dismiss="modal">&times;</button >'+

                                                '<h4 class="modal-title">Alert</h4>'+

                                            '</div>'+

                                            '<p>Une erreur est survenu lors de l\'édition. <br>'+

                                                'Veuillez ressayer!</p>'+

                                        '</div>'+

                                    '</div>'+

                                '</div>'+


                                //<!--*******************************Fin Editer Pagnet****************************************-->'+



                                //<!--*******************************Debut Facture****************************************-->'+




                                    '<button type="submit" class="btn btn-warning pull-right" style="margin-right:20px;" data-toggle="modal" data-target=#msg_fact_pagnet'+lesPaniers[i].idPagnet+'>'+

                                        'Facture'+

                                    '</button >'+






                                '<div class="modal fade" id="msg_fact_pagnet'+lesPaniers[i].idPagnet+'" role="dialog">'+

                                    '<div class="modal-dialog">'+

                                        //<!-- Modal content-->'+

                                        '<div class="modal-content">'+

                                            '<div class="modal-header panel-primary">'+

                                                '<button type="button" class="close" data-dismiss="modal">&times;</button >'+

                                                '<h4 class="modal-title">Informations Client</h4>'+

                                            '</div>'+

                                            '<form  class=" noImpr"  method="post"  id="idPanierFac'+lesPaniers[i].idPagnet+'"  value="'+lesPaniers[i].idPagnet+'" >'+

                                                    '<div class="modal-body">'+

                                                        '<div class="form-group">'+

                                                            '<label for="inputEmail3" class="control-label">Nom Complet </label>'+

                                                            '<input type="text" class="form-control" name="entreprise" id="nomclient'+lesPaniers[i].idPagnet+'" required="" placeholder="Le nom complet ici...">'+

                                                        '</div>'+

                                                        '<div class="row">'+

                                                            '<div class="col-xs-6">'+

                                                                '<label for="reference">Adresse Client</label>'+

                                                                '<input type="text" class="form-control" name="adresse" id="adresseclient'+lesPaniers[i].idPagnet+'">'+

                                                            '</div>'+

                                                            '<div class="col-xs-6">'+

                                                                '<label for="reference">Telephone Client</label>'+

                                                                '<input type="text" class="form-control" name="telephone" id="telephone'+lesPaniers[i].idPagnet+'" >'+

                                                            '</div>'+

                                                        '</div>'+

                                                        '<input type="hidden" name="idPagnet" id="idPanierF" value="'+lesPaniers[i].idPagnet+'">'+

                                                    '</div>'+

                                                    '<div class="modal-footer">'+

                                                        '<button type="button" class="btn btn-default" data-dismiss="modal">Close</button >'+

                                                        '<button type="submit" name="btnFacture" class="btn btn-success"'+
                                                        'onclick="imprimerFacture('+lesPaniers[i].idPagnet+')">Confirmer</button >'+

                                                    '</div>'+

                                                '</form>'+

                                        '</div>'+

                                    '</div>'+

                                '</div>'+

                                //<!--*******************************Fin Facture****************************************-->'+




                                '<button  class="btn btn-info  pull-right" style="margin-right:20px;" onclick="imprimerTicket('+lesPaniers[i].idPagnet+')">'+

                                    'Ticket de Caisse'+

                                '</button >'+






                                '<form  class="form-inline pull-right noImpr" id="ticket'+lesPaniers[i].idPagnet+'"  target="_blank" style="margin-right:20px;"'+

                                'method="post" action="ticketCaisse.html" >'+

                                '<input type="hidden" name="idPagnet" id="idPagnet"  value='+lesPaniers[i].idPagnet+' >'+

                                '</form>'+


                                        '<table  id=tablePanier'+lesPaniers[i].idPagnet+' class="tabPanier table"  width="100%" >'+

                                            '<thead>'+

                                                '<tr>'+

                                                    '<th>Référence</th>'+

                                                    '<th>Quantité</th>'+

                                                    '<th>Unité Vente</th>'+

                                                    '<th>Prix Unité Vente</th>'+

                                                '</tr>'+

                                            '</thead>'+

                                            '<tbody>'+
                                            
                                                

                                                
                                            '</tbody>'+

                                        '</table>'+
                                        '<div>'+

                                            '<div>********************************************* <br/>TOTAL : '+lesPaniers[i].totalp+'<br/></div>'+

                                            '<div id="remise"><br/></div>'+

                                            '<div id="apayer"><b>Net A  payer : '+lesPaniers[i].apayerPagnet+'</b><br/></div>'+

                                            '<div id="compte"><br/></div>'+

                                            '<div id="espece"><br/></div>'+

                                            '<div id="rendu"><br/></div>'+

                                            '<div id="avance"><br/></div>'+

                                            '<div id="reste"><br/></div>'+

                                            '<div id="compte2"><br/></div>'+

                                        '</div>'+
                                        

                                    '</div>'+

                                    '</div>'+
                                '</div>';

                                $("#accordion").prepend(p); 
                                var lignes=JSON.parse(localStorage.getItem("ligne"));
                                if(lignes!=null){
                                for(var j=0; j<lignes.length; j++){
                                    if(lesPaniers[i].idPagnet==lignes[j].idPagnet){
                                        var l="<tr>" +

                                                    "<td>" + lignes[j].designation + "</td>" +

                                                    "<td>"+lignes[j].quantite+"</td>" +

                                                    "<td>"+lignes[j].unitevente+"</td>" +

                                                    "<td>"+lignes[j].prixunitevente +"</td>" +
                                                
                                                    '<td>'+

                                                        '<button  type="submit" 	 class="btn btn-danger pull-right" data-toggle="modal" data-target="#msg_rtrnApres_ligne'+lignes[j].numligne+'">'+

                                                                '<span class="glyphicon glyphicon-remove"></span>Retour'+

                                                        '</button>'+



                                                        '<div class="modal fade" id="msg_rtrnApres_ligne'+lignes[j].numligne+'" role="dialog">'+

                                                            '<div class="modal-dialog">'+

                                                                //<!-- Modal content-->'+

                                                                '<div class="modal-content">'+

                                                                    '<div class="modal-header panel-primary">'+

                                                                        '<button type="button" class="close" data-dismiss="modal">&times;</button>'+

                                                                        '<h4 class="modal-title">Confirmation</h4>'+

                                                                    '</div>'+

                                                                    '<form class="form-inline noImpr" id="factForm" method="post" >'+

                                                                        '<div class="modal-body">'+

                                                                            '<p>Voulez-vous retourner cette ligne du panier numéro <b>'+idPanier+'</b></p>'+

                                                                            // '<input type="hidden" name="idPagnet" id="idPagnet2618" value=1725 >'+

                                                                            // '<input type="hidden" name="designation" id="designation2618" value=Farine de niebe >'+

                                                                            // '<input type="hidden" name="numligne" id="numligne2618" value=2618 >'+

                                                                            // '<input type="hidden" name="idStock" id="idStock2618" value=0 >'+

                                                                            // '<input type="hidden" name="unitevente" id="unitevente2618" value=article >'+

                                                                            // '<input type="hidden" name="prixunitevente" id="prixunitevente2618" value=750 >'+

                                                                            // '<input type="hidden" name="prixtotal" id="prixtotal2618" value=750 >'+

                                                                            // '<input type="hidden" name="totalp" id="totalp2618" value=750 >'+

                                                                            '<div class="row">'+

                                                                                '<div class="col-xs-6">'+

                                                                                    '<label for="reference">Ancienne quantite </label>'+

                                                                                    '<input type="text" disabled="true" class="form-control" value=1 >'+

                                                                                '</div>'+

                                                                                '<div class="col-xs-6">'+

                                                                                    '<label for="reference">Nouvelle quantite</label>'+

                                                                                    '<input type="text" class="form-control inputRetourApres" name="quantite" data-numligne="'+lignes[j].numligne+'" id="quantite'+lignes[j].numligne+'" value=1 >'+

                                                                                '</div>'+

                                                                            '</div>'+

                                                                        '</div>'+

                                                                        '<div class="modal-footer">'+

                                                                            '<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>'+

                                                                            '<button type="button"  name="btnRetourApres" data-numligne="'+lignes[j].numligne+'" class="btn btn-success btnRetourApres">Confirmer'+

                                                                                '<img src="images/loading-gif3.gif" class="img-load-retourApres" style="height: 30px;width: 30px; display:none;" alt="GIF" srcset=""> </button>'+

                                                                        '</div>'+

                                                                    '</form>'+

                                                                '</div>'+

                                                            '</div>'+

                                                        '</div>'+
                                                    '</td>'+


                                                "</tr>";

                                        $("#tablePanier"+lesPaniers[i].idPagnet).prepend(l);

                                        var searchPanier=lesPaniers.find(p =>p.idPagnet==lesPaniers[i].idPagnet);
                                        var lesComptes=getCompte();

                                        var searchCompte=lesComptes.find(c =>c.idCompte==lesPaniers[i].idCompte);  
                                        

                                        document.getElementById('compte').innerHTML='Compte : '+searchCompte.nomCompte

                                        if(searchPanier.remise==0){
                                            divRemise='<div></div>';
                                            document.getElementById('remise').innerHTML=divRemise
                                            //$('#remise').hide
                                            
                                        
                                        }
                                        else{
                                            document.getElementById('remise').innerHTML='Remise : '+searchPanier.remise
                                        }
                                        if(searchPanier.versement==0){
                                            divEspece='<div></div>';
                                            divRendu='<div></div>';
                                            document.getElementById('espece').innerHTML=divEspece
                                            document.getElementById('rendu').innerHTML=divRendu
                                            // $('#espece').hide
                                            // $('#rendu').hide
                                        }
                                        else{

                                            document.getElementById('espece').innerHTML='Espèce : '+searchPanier.versement
                                            document.getElementById('rendu').innerHTML='Rendu : '+searchPanier.restourne
                                        }
                                        if(searchPanier.avance==0 || searchPanier.avance==""){
                                            divAvance='<div></div>';
                                            divReste='<div></div>';
                                            document.getElementById('avance').innerHTML=divAvance
                                            document.getElementById('reste').innerHTML=divReste
                                            
                                        }
                                        else{
                                            
                                            document.getElementById('avance').innerHTML='Avance : '+searchPanier.avance
                                            document.getElementById('reste').innerHTML='Reste : '+parseInt(searchPanier.apayerPagnet-searchPanier.avance)
                                            var idCompte2=localStorage.getItem('idCompte2')
                                            var searchCompte=lesComptes.find(c =>c.idCompte==idCompte2);
                                            
                                            document.getElementById('compte2').innerHTML='Compte avance : '+searchCompte.nomCompte
                                            
                                            
                                        }
                                    }
                                }
                                }

                            }
                        }  
                        else{
                            if(lesPaniers[i].synchronise==0){
                                //alert('OK')
                                var p= '<div class="panel panel-warning" id=panelPanier'+lesPaniers[i].idPagnet+'>'+

                                    '<div class="panel-heading">'+

                                        '<h4 data-toggle="collapse" data-parent="#accordion" href="#pagnet'+lesPaniers[i].idPagnet+'"  class="panel-title expand">'+

                                            '<div class="right-arrow pull-right">+</div>'+

                                            '<a class="row" href="#">'+ 

                                                '<span class="noImpr col-md-2 col-sm-2 col-xs-12" id=paniertermine'+lesPaniers[i].idPagnet+'> Panier '+(i+1)+'</span>'+

                                                '<span class="noImpr col-md-1 col-sm-2 col-xs-12">'+lesPaniers[i].heurePagnet+'</span>'+

                                                '<span class="noImpr col-md-2 col-sm-2 col-xs-12" >Total panier: <span id=somme_Total'+lesPaniers[i].idPagnet+' >'+lesPaniers[i].totalp+'</span></span>'+

                                                '<span class="noImpr col-md-2 col-sm-3 col-xs-12" >Total A  payer: <span id=somme_Apayer'+lesPaniers[i].idPagnet+' >'+lesPaniers[i].apayerPagnet+'</span></span>'+ 

                                                '<span class="noImpr col-md-2 col-sm-3 col-xs-12" > Facture : #'+(i+1)+'</span>'+

                                                '<span class="noImpr col-md-2 col-sm-3 col-xs-12">'+prenom.toUpperCase()+'</span>'+                

                                            '</a>'+

                                        '</h4>'+

                                    '</div>'+
                                    '<div id=pagnet'+lesPaniers[i].idPagnet+' class="panel-collapse collapse" > '+

                                        '<div class="panel-body" >'+

                                    //<!--*******************************Debut Retourner Pagnet****************************************-->'+

                                    '<button type="submit" 	 class="btn btn-danger pull-right" data-toggle="modal" data-target=#msg_rtrn_pagnet'+lesPaniers[i].idPagnet+'>'+

                                            '<span class="glyphicon glyphicon-remove"></span>Retourner'+

                                    '</button >'+



                                    '<div class="modal fade" id="msg_rtrn_pagnet'+lesPaniers[i].idPagnet+'" role="dialog">'+

                                        '<div class="modal-dialog">'+


                                            '<div class="modal-content">'+

                                                '<div class="modal-header panel-primary">'+

                                                    '<button type="button" class="close" data-dismiss="modal">&times;</button >'+

                                                    '<h4 class="modal-title">Confirmation</h4>'+

                                                '</div>'+

                                                '<form  class="form-inline noImpr"  id="factForm" method="post"  >'+

                                                    '<div class="modal-body">'+

                                                        '<p>Voulez-vous retourner le panier numéro <b>'+lesPaniers[i].idPagnet+'"<b></p>'+

                                                        '<input type="hidden" name="idPagnet" id="idPagnet"  value='+lesPaniers[i].idPagnet+'>'+

                                                    '</div>'+

                                                    '<div class="modal-footer">'+

                                                        '<button type="button" class="btn btn-default" data-dismiss="modal">Close</button >'+

                                                        '<button type="button" name="btnRetournerPagnet" data-idPanier='+lesPaniers[i].idPagnet+' class="btn btn-success btnRetournerPagnet">Confirmer<img src="images/loading-gif3.gif" class="img-load-retournerPanier" style="height: 30px;width: 30px; display:none;" alt="GIF" srcset=""></button >'+

                                                    '</div>'+

                                                '</form>'+

                                            '</div>'+

                                        '</div>'+

                                    '</div>'+

                                    //<!--*******************************Fin Retourner Pagnet****************************************-->'+



                                    //<!--*******************************Debut Editer Pagnet****************************************-->'+


                                    '<button type="button" class="btn btn-primary pull-left modeEditionBtn" id="edit-'+lesPaniers[i].idPagnet+'">'+

                                        '<span class="glyphicon glyphicon-edit"></span> Editer<img src="images/loading-gif3.gif" class="img-load-editer" style="height: 30px;width: 30px;display:none;" alt="GIF" srcset="">'+

                                    '</button >'+



                                    '<div class="modal fade" id="msg_edit_pagnet'+lesPaniers[i].idPagnet+'" role="dialog">'+

                                        '<div class="modal-dialog">'+

                                            '<div class="modal-content">'+

                                                '<div class="modal-header panel-primary">'+

                                                    '<button type="button" class="close" data-dismiss="modal">&times;</button >'+

                                                    '<h4 class="modal-title">Alert</h4>'+

                                                '</div>'+

                                                '<p>Une erreur est survenu lors de l\'édition. <br>'+

                                                    'Veuillez ressayer!</p>'+

                                            '</div>'+

                                        '</div>'+

                                    '</div>'+


                                    //<!--*******************************Fin Editer Pagnet****************************************-->'+



                                    //<!--*******************************Debut Facture****************************************-->'+




                                        '<button type="submit" class="btn btn-warning pull-right" style="margin-right:20px;" data-toggle="modal" data-target=#msg_fact_pagnet'+lesPaniers[i].idPagnet+'>'+

                                            'Facture'+

                                        '</button >'+






                                    '<div class="modal fade" id="msg_fact_pagnet'+lesPaniers[i].idPagnet+'" role="dialog">'+

                                        '<div class="modal-dialog">'+

                                            //<!-- Modal content-->'+

                                            '<div class="modal-content">'+

                                                '<div class="modal-header panel-primary">'+

                                                    '<button type="button" class="close" data-dismiss="modal">&times;</button >'+

                                                    '<h4 class="modal-title">Informations Client</h4>'+

                                                '</div>'+

                                                '<form  class=" noImpr"  method="post"  id="idPanierFac'+lesPaniers[i].idPagnet+'"  value="'+lesPaniers[i].idPagnet+'" >'+

                                                        '<div class="modal-body">'+

                                                            '<div class="form-group">'+

                                                                '<label for="inputEmail3" class="control-label">Nom Complet </label>'+

                                                                '<input type="text" class="form-control" name="entreprise" id="nomclient'+lesPaniers[i].idPagnet+'" required="" placeholder="Le nom complet ici...">'+

                                                            '</div>'+

                                                            '<div class="row">'+

                                                                '<div class="col-xs-6">'+

                                                                    '<label for="reference">Adresse Client</label>'+

                                                                    '<input type="text" class="form-control" name="adresse" id="adresseclient'+lesPaniers[i].idPagnet+'">'+

                                                                '</div>'+

                                                                '<div class="col-xs-6">'+

                                                                    '<label for="reference">Telephone Client</label>'+

                                                                    '<input type="text" class="form-control" name="telephone" id="telephone'+lesPaniers[i].idPagnet+'" >'+

                                                                '</div>'+

                                                            '</div>'+

                                                            '<input type="hidden" name="idPagnet" id="idPanierF" value="'+lesPaniers[i].idPagnet+'">'+

                                                        '</div>'+

                                                        '<div class="modal-footer">'+

                                                            '<button type="button" class="btn btn-default" data-dismiss="modal">Close</button >'+

                                                            '<button type="submit" name="btnFacture" class="btn btn-success"'+
                                                            'onclick="imprimerFacture('+lesPaniers[i].idPagnet+')">Confirmer</button >'+

                                                        '</div>'+

                                                    '</form>'+

                                            '</div>'+

                                        '</div>'+

                                    '</div>'+

                                    //<!--*******************************Fin Facture****************************************-->'+




                                    '<button  class="btn btn-info  pull-right" style="margin-right:20px;" onclick="imprimerTicket('+lesPaniers[i].idPagnet+')">'+

                                        'Ticket de Caisse'+

                                    '</button >'+






                                    '<form  class="form-inline pull-right noImpr" id="ticket'+lesPaniers[i].idPagnet+'"  target="_blank" style="margin-right:20px;"'+

                                    'method="post" action="ticketCaisse.html" >'+

                                    '<input type="hidden" name="idPagnet" id="idPagnet"  value='+lesPaniers[i].idPagnet+' >'+

                                    '</form>'+


                                            '<table  id=tablePanier'+lesPaniers[i].idPagnet+' class="tabPanier table"  width="100%" >'+

                                                '<thead>'+

                                                    '<tr>'+

                                                        '<th>Référence</th>'+

                                                        '<th>Quantité</th>'+

                                                        '<th>Unité Vente</th>'+

                                                        '<th>Prix Unité Vente</th>'+

                                                    '</tr>'+

                                                '</thead>'+

                                                '<tbody>'+
                                                
                                                    

                                                    
                                                '</tbody>'+

                                            '</table>'+
                                            '<div>'+

                                            '<div>********************************************* <br/>TOTAL : '+lesPaniers[i].totalp+'</div>'+

                                            '<div id="remise"></div>'+

                                            '<div id="apayer"><b>Net A  payer : '+lesPaniers[i].apayerPagnet+'</b></div>'+

                                            '<div id="compte"></div>'+

                                            '<div id="espece"></div>'+

                                            '<div id="rendu"></div>'+

                                            '<div id="avance"></div>'+

                                            '<div id="reste"></div>'+

                                            '<div id="compte2"></div>'+

                                            '</div>'+

                                        '</div>'+

                                        '</div>'+
                                    '</div>';
                                                
                                    $("#accordion").prepend(p); 
                                    var lignes=JSON.parse(localStorage.getItem("ligne"));
                                    if(lignes!=null){
                                    for(var j=0; j<lignes.length; j++){
                                        if(lesPaniers[i].idPagnet==lignes[j].idPagnet){
                                            var l="<tr>" +

                                                        "<td>" + lignes[j].designation + "</td>" +

                                                        "<td>"+lignes[j].quantite+"</td>" +

                                                        "<td>"+lignes[j].unitevente+"</td>" +

                                                        "<td>"+lignes[j].prixunitevente +"</td>" +
                                                    
                                                        '<td>'+

                                                            '<button  type="submit" 	 class="btn btn-danger pull-right" data-toggle="modal" data-target="#msg_rtrnApres_ligne'+lignes[j].numligne+'">'+

                                                                    '<span class="glyphicon glyphicon-remove"></span>Retour'+

                                                            '</button>'+



                                                            '<div class="modal fade" id="msg_rtrnApres_ligne'+lignes[j].numligne+'" role="dialog">'+

                                                                '<div class="modal-dialog">'+

                                                                    //<!-- Modal content-->'+

                                                                    '<div class="modal-content">'+

                                                                        '<div class="modal-header panel-primary">'+

                                                                            '<button type="button" class="close" data-dismiss="modal">&times;</button>'+

                                                                            '<h4 class="modal-title">Confirmation</h4>'+

                                                                        '</div>'+

                                                                        '<form class="form-inline noImpr" id="factForm" method="post" >'+

                                                                            '<div class="modal-body">'+

                                                                                '<p>Voulez-vous retourner cette ligne du panier numéro <b>'+idPanier+'</b></p>'+

                                                                                // '<input type="hidden" name="idPagnet" id="idPagnet2618" value=1725 >'+

                                                                                // '<input type="hidden" name="designation" id="designation2618" value=Farine de niebe >'+

                                                                                // '<input type="hidden" name="numligne" id="numligne2618" value=2618 >'+

                                                                                // '<input type="hidden" name="idStock" id="idStock2618" value=0 >'+

                                                                                // '<input type="hidden" name="unitevente" id="unitevente2618" value=article >'+

                                                                                // '<input type="hidden" name="prixunitevente" id="prixunitevente2618" value=750 >'+

                                                                                // '<input type="hidden" name="prixtotal" id="prixtotal2618" value=750 >'+

                                                                                // '<input type="hidden" name="totalp" id="totalp2618" value=750 >'+

                                                                                '<div class="row">'+

                                                                                    '<div class="col-xs-6">'+

                                                                                        '<label for="reference">Ancienne quantite </label>'+

                                                                                        '<input type="text" disabled="true" class="form-control" value=1 >'+

                                                                                    '</div>'+

                                                                                    '<div class="col-xs-6">'+

                                                                                        '<label for="reference">Nouvelle quantite</label>'+

                                                                                        '<input type="text" class="form-control inputRetourApres" name="quantite" data-numligne="'+lignes[j].numligne+'" id="quantite'+lignes[j].numligne+'" value=1 >'+

                                                                                    '</div>'+

                                                                                '</div>'+

                                                                            '</div>'+

                                                                            '<div class="modal-footer">'+

                                                                                '<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>'+

                                                                                '<button type="button"  name="btnRetourApres" data-numligne="'+lignes[j].numligne+'" class="btn btn-success btnRetourApres">Confirmer'+

                                                                                    '<img src="images/loading-gif3.gif" class="img-load-retourApres" style="height: 30px;width: 30px; display:none;" alt="GIF" srcset=""> </button>'+

                                                                            '</div>'+

                                                                        '</form>'+

                                                                    '</div>'+

                                                                '</div>'+

                                                            '</div>'+
                                                        '</td>'+


                                                    "</tr>";

                                            $("#tablePanier"+lesPaniers[i].idPagnet).prepend(l);

                                            var searchPanier=lesPaniers.find(p =>p.idPagnet==lesPaniers[i].idPagnet);
                                            
                                            var lesComptes=getCompte();
                                            
                                            var searchCompte=lesComptes.find(c =>c.idCompte==lesPaniers[i].idCompte); 
                                            

                                            document.getElementById('compte').innerHTML='Compte : '+searchCompte.nomCompte

                                            if(searchPanier.remise==0){
                                                divRemise='<div></div>';
                                                document.getElementById('remise').innerHTML=divRemise
                                                //$('#remise').hide
                                                
                                            
                                            }
                                            else{
                                                document.getElementById('remise').innerHTML='Remise : '+searchPanier.remise
                                            }
                                            if(searchPanier.versement==0){
                                                divEspece='<div></div>';
                                                divRendu='<div></div>';
                                                document.getElementById('espece').innerHTML=divEspece
                                                document.getElementById('rendu').innerHTML=divRendu
                                                // $('#espece').hide
                                                // $('#rendu').hide
                                            }
                                            else{

                                                document.getElementById('espece').innerHTML='Espèce : '+searchPanier.versement
                                                document.getElementById('rendu').innerHTML='Rendu : '+searchPanier.restourne
                                            }
                                            if(searchPanier.avance==0 || searchPanier.avance==""){
                                                divAvance='<div></div>';
                                                divReste='<div></div>';
                                                document.getElementById('avance').innerHTML=divAvance
                                                document.getElementById('reste').innerHTML=divReste
                                                // document.getElementById('avance').innerHTML='Avance : '+searchPanier.avance
                                                // document.getElementById('reste').innerHTML='Reste : '+parseInt(searchPanier.apayerPagnet-searchPanier.avance)
                                                // var idCompte2=localStorage.getItem('idCompte2')
                                                // var searchCompte=lesComptes.find(c =>c.idCompte==idCompte2);
                                                
                                                // document.getElementById('compte2').innerHTML='Compte avance : '+searchCompte.nomCompte
                                            }
                                            else{
                                                
                                                document.getElementById('avance').innerHTML='Avance : '+searchPanier.avance
                                                document.getElementById('reste').innerHTML='Reste : '+parseInt(searchPanier.apayerPagnet-searchPanier.avance)
                                                var idCompte2=localStorage.getItem('idCompte2')
                                                var searchCompte=lesComptes.find(c =>c.idCompte==idCompte2);
                                                
                                                document.getElementById('compte2').innerHTML='Compte avance : '+searchCompte.nomCompte
                                                
                                                
                                            }
                                        }
                                    }
                                }

                            }
                            else{
                                
                                var p= '<div class="panel panel-success" id=panelPanier'+lesPaniers[i].idPagnet+'>'+

                                '<div class="panel-heading">'+

                                    '<h4 data-toggle="collapse" data-parent="#accordion" href="#pagnet'+lesPaniers[i].idPagnet+'"  class="panel-title expand">'+

                                        '<div class="right-arrow pull-right">+</div>'+

                                        '<a class="row" href="#">'+ 

                                            '<span class="noImpr col-md-2 col-sm-2 col-xs-12" id=paniertermine'+lesPaniers[i].idPagnet+'> Panier '+(i+1)+'</span>'+

                                            '<span class="noImpr col-md-1 col-sm-2 col-xs-12">'+lesPaniers[i].heurePagnet+'</span>'+

                                            '<span class="noImpr col-md-2 col-sm-2 col-xs-12" >Total panier: <span id=somme_Total'+lesPaniers[i].idPagnet+' >'+lesPaniers[i].totalp+'</span></span>'+

                                            '<span class="noImpr col-md-2 col-sm-3 col-xs-12" >Total A  payer: <span id=somme_Apayer'+lesPaniers[i].idPagnet+' >'+lesPaniers[i].apayerPagnet+'</span></span>'+ 

                                            '<span class="noImpr col-md-2 col-sm-3 col-xs-12" > Facture : #'+(i+1)+'</span>'+

                                            '<span class="noImpr col-md-2 col-sm-3 col-xs-12">'+prenom.toUpperCase()+'</span>'+                

                                        '</a>'+

                                    '</h4>'+

                                '</div>'+
                                '<div id=pagnet'+lesPaniers[i].idPagnet+' class="panel-collapse collapse" > '+

                                    '<div class="panel-body" >'+

                                //<!--*******************************Debut Retourner Pagnet****************************************-->'+

                                '<button type="submit" 	 class="btn btn-danger pull-right" data-toggle="modal" data-target=#msg_rtrn_pagnet'+lesPaniers[i].idPagnet+'>'+

                                        '<span class="glyphicon glyphicon-remove"></span>Retourner'+

                                '</button >'+



                                '<div class="modal fade" id="msg_rtrn_pagnet'+lesPaniers[i].idPagnet+'" role="dialog">'+

                                    '<div class="modal-dialog">'+


                                        '<div class="modal-content">'+

                                            '<div class="modal-header panel-primary">'+

                                                '<button type="button" class="close" data-dismiss="modal">&times;</button >'+

                                                '<h4 class="modal-title">Confirmation</h4>'+

                                            '</div>'+

                                            '<form  class="form-inline noImpr"  id="factForm" method="post"  >'+

                                                '<div class="modal-body">'+

                                                    '<p>Voulez-vous retourner le panier numéro <b>'+lesPaniers[i].idPagnet+'"<b></p>'+

                                                    '<input type="hidden" name="idPagnet" id="idPagnet"  value='+lesPaniers[i].idPagnet+'>'+

                                                '</div>'+

                                                '<div class="modal-footer">'+

                                                    '<button type="button" class="btn btn-default" data-dismiss="modal">Close</button >'+

                                                    '<button type="button" name="btnRetournerPagnet" data-idPanier='+lesPaniers[i].idPagnet+' class="btn btn-success btnRetournerPagnet">Confirmer<img src="images/loading-gif3.gif" class="img-load-retournerPanier" style="height: 30px;width: 30px; display:none;" alt="GIF" srcset=""></button >'+

                                                '</div>'+

                                            '</form>'+

                                        '</div>'+

                                    '</div>'+

                                '</div>'+

                                //<!--*******************************Fin Retourner Pagnet****************************************-->'+



                                //<!--*******************************Debut Editer Pagnet****************************************-->'+


                                '<button type="button" class="btn btn-primary pull-left modeEditionBtn" id="edit-'+lesPaniers[i].idPagnet+'">'+

                                    '<span class="glyphicon glyphicon-edit"></span> Editer<img src="images/loading-gif3.gif" class="img-load-editer" style="height: 30px;width: 30px;display:none;" alt="GIF" srcset="">'+

                                '</button >'+



                                '<div class="modal fade" id="msg_edit_pagnet'+lesPaniers[i].idPagnet+'" role="dialog">'+

                                    '<div class="modal-dialog">'+

                                        '<div class="modal-content">'+

                                            '<div class="modal-header panel-primary">'+

                                                '<button type="button" class="close" data-dismiss="modal">&times;</button >'+

                                                '<h4 class="modal-title">Alert</h4>'+

                                            '</div>'+

                                            '<p>Une erreur est survenu lors de l\'édition. <br>'+

                                                'Veuillez ressayer!</p>'+

                                        '</div>'+

                                    '</div>'+

                                '</div>'+


                                //<!--*******************************Fin Editer Pagnet****************************************-->'+



                                //<!--*******************************Debut Facture****************************************-->'+




                                    '<button type="submit" class="btn btn-warning pull-right" style="margin-right:20px;" data-toggle="modal" data-target=#msg_fact_pagnet'+lesPaniers[i].idPagnet+'>'+

                                        'Facture'+

                                    '</button >'+






                                '<div class="modal fade" id="msg_fact_pagnet'+lesPaniers[i].idPagnet+'" role="dialog">'+

                                    '<div class="modal-dialog">'+

                                        //<!-- Modal content-->'+

                                        '<div class="modal-content">'+

                                            '<div class="modal-header panel-primary">'+

                                                '<button type="button" class="close" data-dismiss="modal">&times;</button >'+

                                                '<h4 class="modal-title">Informations Client</h4>'+

                                            '</div>'+

                                            '<form  class=" noImpr"  method="post"  id="idPanierFac'+lesPaniers[i].idPagnet+'"  value="'+lesPaniers[i].idPagnet+'" >'+

                                                    '<div class="modal-body">'+

                                                        '<div class="form-group">'+

                                                            '<label for="inputEmail3" class="control-label">Nom Complet </label>'+

                                                            '<input type="text" class="form-control" name="entreprise" id="nomclient'+lesPaniers[i].idPagnet+'" required="" placeholder="Le nom complet ici...">'+

                                                        '</div>'+

                                                        '<div class="row">'+

                                                            '<div class="col-xs-6">'+

                                                                '<label for="reference">Adresse Client</label>'+

                                                                '<input type="text" class="form-control" name="adresse" id="adresseclient'+lesPaniers[i].idPagnet+'">'+

                                                            '</div>'+

                                                            '<div class="col-xs-6">'+

                                                                '<label for="reference">Telephone Client</label>'+

                                                                '<input type="text" class="form-control" name="telephone" id="telephone'+lesPaniers[i].idPagnet+'" >'+

                                                            '</div>'+

                                                        '</div>'+

                                                        '<input type="hidden" name="idPagnet" id="idPanierF" value="'+lesPaniers[i].idPagnet+'">'+

                                                    '</div>'+

                                                    '<div class="modal-footer">'+

                                                        '<button type="button" class="btn btn-default" data-dismiss="modal">Close</button >'+

                                                        '<button type="submit" name="btnFacture" class="btn btn-success"'+
                                                        'onclick="imprimerFacture('+lesPaniers[i].idPagnet+')">Confirmer</button >'+

                                                    '</div>'+

                                                '</form>'+

                                        '</div>'+

                                    '</div>'+

                                '</div>'+

                                //<!--*******************************Fin Facture****************************************-->'+




                                '<button  class="btn btn-info  pull-right" style="margin-right:20px;" onclick="imprimerTicket('+lesPaniers[i].idPagnet+')">'+

                                    'Ticket de Caisse'+

                                '</button >'+






                                '<form  class="form-inline pull-right noImpr" id="ticket'+lesPaniers[i].idPagnet+'"  target="_blank" style="margin-right:20px;"'+

                                'method="post" action="ticketCaisse.html" >'+

                                '<input type="hidden" name="idPagnet" id="idPagnet"  value='+lesPaniers[i].idPagnet+' >'+

                                '</form>'+


                                        '<table  id=tablePanier'+lesPaniers[i].idPagnet+' class="tabPanier table"  width="100%" >'+

                                            '<thead>'+

                                                '<tr>'+

                                                    '<th>Référence</th>'+

                                                    '<th>Quantité</th>'+

                                                    '<th>Unité Vente</th>'+

                                                    '<th>Prix Unité Vente</th>'+

                                                '</tr>'+

                                            '</thead>'+

                                            '<tbody>'+
                                            
                                                

                                                
                                            '</tbody>'+

                                        '</table>'+
                                        '<div>'+

                                        '<div>********************************************* <br/>TOTAL : '+lesPaniers[i].totalp+'</div>'+

                                        '<div id="remise"></div>'+

                                        '<div id="apayer"><b>Net A  payer : '+lesPaniers[i].apayerPagnet+'</b></div>'+

                                        '<div id="compte"></div>'+

                                        '<div id="espece"></div>'+

                                        '<div id="rendu"></div>'+

                                        '<div id="avance"></div>'+

                                        '<div id="reste"></div>'+

                                        '<div id="compte2"></div>'+

                                        '</div>'+

                                    '</div>'+

                                    '</div>'+
                                '</div>';


                                $("#accordion").prepend(p); 
                                var lignes=JSON.parse(localStorage.getItem("ligne"));
                                if(lignes!=null){
                                for(var j=0; j<lignes.length; j++){
                                    if(lesPaniers[i].idPagnet==lignes[j].idPagnet){
                                        var l="<tr>" +

                                                    "<td>" + lignes[j].designation + "</td>" +

                                                    "<td>"+lignes[j].quantite+"</td>" +

                                                    "<td>"+lignes[j].unitevente+"</td>" +

                                                    "<td>"+lignes[j].prixunitevente +"</td>" +
                                                
                                                    '<td>'+

                                                        '<button  type="submit" 	 class="btn btn-danger pull-right" data-toggle="modal" data-target="#msg_rtrnApres_ligne'+lignes[j].numligne+'">'+

                                                                '<span class="glyphicon glyphicon-remove"></span>Retour'+

                                                        '</button>'+



                                                        '<div class="modal fade" id="msg_rtrnApres_ligne'+lignes[j].numligne+'" role="dialog">'+

                                                            '<div class="modal-dialog">'+

                                                                //<!-- Modal content-->'+

                                                                '<div class="modal-content">'+

                                                                    '<div class="modal-header panel-primary">'+

                                                                        '<button type="button" class="close" data-dismiss="modal">&times;</button>'+

                                                                        '<h4 class="modal-title">Confirmation</h4>'+

                                                                    '</div>'+

                                                                    '<form class="form-inline noImpr" id="factForm" method="post" >'+

                                                                        '<div class="modal-body">'+

                                                                            '<p>Voulez-vous retourner cette ligne du panier numéro <b>'+idPanier+'</b></p>'+

                                                                            // '<input type="hidden" name="idPagnet" id="idPagnet2618" value=1725 >'+

                                                                            // '<input type="hidden" name="designation" id="designation2618" value=Farine de niebe >'+

                                                                            // '<input type="hidden" name="numligne" id="numligne2618" value=2618 >'+

                                                                            // '<input type="hidden" name="idStock" id="idStock2618" value=0 >'+

                                                                            // '<input type="hidden" name="unitevente" id="unitevente2618" value=article >'+

                                                                            // '<input type="hidden" name="prixunitevente" id="prixunitevente2618" value=750 >'+

                                                                            // '<input type="hidden" name="prixtotal" id="prixtotal2618" value=750 >'+

                                                                            // '<input type="hidden" name="totalp" id="totalp2618" value=750 >'+

                                                                            '<div class="row">'+

                                                                                '<div class="col-xs-6">'+

                                                                                    '<label for="reference">Ancienne quantite </label>'+

                                                                                    '<input type="text" disabled="true" class="form-control" value=1 >'+

                                                                                '</div>'+

                                                                                '<div class="col-xs-6">'+

                                                                                    '<label for="reference">Nouvelle quantite</label>'+

                                                                                    '<input type="text" class="form-control inputRetourApres" name="quantite" data-numligne="'+lignes[j].numligne+'" id="quantite'+lignes[j].numligne+'" value=1 >'+

                                                                                '</div>'+

                                                                            '</div>'+

                                                                        '</div>'+

                                                                        '<div class="modal-footer">'+

                                                                            '<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>'+

                                                                            '<button type="button"  name="btnRetourApres" data-numligne="'+lignes[j].numligne+'" class="btn btn-success btnRetourApres">Confirmer'+

                                                                                '<img src="images/loading-gif3.gif" class="img-load-retourApres" style="height: 30px;width: 30px; display:none;" alt="GIF" srcset=""> </button>'+

                                                                        '</div>'+

                                                                    '</form>'+

                                                                '</div>'+

                                                            '</div>'+

                                                        '</div>'+
                                                    '</td>'+


                                                "</tr>";

                                        $("#tablePanier"+lesPaniers[i].idPagnet).prepend(l);

                                        var searchPanier=lesPaniers.find(p =>p.idPagnet==lesPaniers[i].idPagnet);
                                        var lesComptes=getCompte();

                                        var searchCompte=lesComptes.find(c =>c.idCompte==lesPaniers[i].idCompte); 
                                        

                                        document.getElementById('compte').innerHTML='Compte : '+searchCompte.nomCompte

                                        if(searchPanier.remise==0){
                                            divRemise='<div></div>';
                                            document.getElementById('remise').innerHTML=divRemise
                                            //$('#remise').hide
                                            
                                        
                                        }
                                        else{
                                            document.getElementById('remise').innerHTML='Remise : '+searchPanier.remise
                                        }
                                        if(searchPanier.versement==0){
                                            divEspece='<div></div>';
                                            divRendu='<div></div>';
                                            document.getElementById('espece').innerHTML=divEspece
                                            document.getElementById('rendu').innerHTML=divRendu
                                            // $('#espece').hide
                                            // $('#rendu').hide
                                        }
                                        else{

                                            document.getElementById('espece').innerHTML='Espèce : '+searchPanier.versement
                                            document.getElementById('rendu').innerHTML='Rendu : '+searchPanier.restourne
                                        }
                                        if(searchPanier.avance==0 || searchPanier.avance==""){
                                            divAvance='<div></div>';
                                            divReste='<div></div>';
                                            document.getElementById('avance').innerHTML=divAvance
                                            document.getElementById('reste').innerHTML=divReste
                                            
                                        }
                                        else{
                                            
                                            document.getElementById('avance').innerHTML='Avance : '+searchPanier.avance
                                            document.getElementById('reste').innerHTML='Reste : '+parseInt(searchPanier.apayerPagnet-searchPanier.avance)
                                            var idCompte2=localStorage.getItem('idCompte2')
                                            var searchCompte=lesComptes.find(c =>c.idCompte==idCompte2);
                                            
                                            document.getElementById('compte2').innerHTML='Compte avance : '+searchCompte.nomCompte
                                            
                                            
                                        }
                                    }
                                }

                                
                                }
                            }

                        }
                        
                    }   
                } 
            
                for(var j=0; j<lesPaniers.length;j++){
                    
                    if(lesPaniers[j].verrouiller==0 && lesPaniers[j].iduser==sessionStorage.iduserSession){
                        var p= '<div class="panel panel-primary" id=panelPanier'+lesPaniers[j].idPagnet+'>'+

                            '<div class="panel-heading">'+

                                '<h4 data-toggle="collapse" data-parent="#accordion" href="#pagnet'+lesPaniers[j].idPagnet+'"  class="panel-title expand">'+

                                    '<div class="right-arrow pull-right">+</div>'+

                                    '<a class="row" href="#">'+ 

                                        '<span class="noImpr col-md-2 col-sm-2 col-xs-12" id="panierEncours'+lesPaniers[j].idPagnet+'"> Panier : En cours... </span>'+

                                        '<span class="noImpr col-md-3 col-sm-3 col-xs-12">Heure: '+lesPaniers[j].heurePagnet+'</span>'+

                                        '<span class="noImpr col-md-3 col-sm-3 col-xs-12" >Total panier: <span id="somme_Total'+lesPaniers[j].idPagnet+'" > '+somme_A_payer()+' </span></span>'+

                                        '<span class="noImpr col-md-3 col-sm-3 col-xs-12" >Total A  payer: <span id="somme_Apayer'+lesPaniers[j].idPagnet+'" >'+somme_A_payer()+'</span></span>'+                 

                                    '</a>'+

                                '</h4>'+

                            '</div>'+
                            '<div id="pagnet'+lesPaniers[j].idPagnet+'" class="panel-collapse collapse in panelVente" > '+

                                '<div class="panel-body" >'+

                                    '<div class="cache_btn_Terminer row" id="cache_btn_Terminer'+lesPaniers[j].idPagnet+'">'+

                                        //<!--*******************************Debut Ajouter Ligne****************************************-->

                                            '<form  class="form-inline noImpr ajouterProdForm col-md-4 col-sm-4 col-xs-12" id="ajouterProdFormB'+lesPaniers[j].idPagnet+'" onsubmit="return false" >'+

                                                '<input type="text" class="inputbasic form-control codeBarreLigneVt" name="codeBarre" id="panier_'+lesPaniers[j].idPagnet+'" data-idPanier='+lesPaniers[j].idPagnet+' style="width:100%;" autofocus="" autocomplete="off"  required />'+

                                                '<input type="hidden" name="idPagnet" id="idPagnet" value='+lesPaniers[j].idPagnet+'>'+

                                            '</form>'+

                                        //<!--*******************************Fin Ajouter Ligne****************************************-->

                                        '<div class="col-md-8 col-sm-8 col-xs-12 content2">'+

                                            //<!--*******************************Debut Terminer Pagnet****************************************-->

                                            '<form class="form-inline noImpr" id="factForm" method="post">'+
                                                //'<div id="compte_caisse'+lesPaniers[j].idPagnet+'">'+
                                                    '<input type="number" id="val_remise1'+lesPaniers[j].idPagnet+'" name="remise"  class="remise form-control col-md-2 col-sm-2 col-xs-3" placeholder="Remise....">'+

                                                    
                                                    '<select class="compte '+lesPaniers[j].idPagnet+' form-control col-md-2 col-sm-2 col-xs-3"  data-idPanier='+lesPaniers[j].idPagnet+' name="compte'+lesPaniers[j].idPagnet+'"  id="compteCaisse'+lesPaniers[j].idPagnet+'">'+
                                                    
                                                    '</select>'+

                                                    '<input type="number" name="versement" id="versement'+lesPaniers[j].idPagnet+'" onkeyup="modif_Versement(this.value, '+lesPaniers[j].idPagnet+')"  placeholder="Espèce..."'+
                                                    'class="versement form-control col-md-2 col-sm-2 col-xs-3" >'+
                                                    '<input type="text" class="client clientInput form-control col-md-2 col-sm-2 col-xs-3"  data-type="simple" data-idPanier="'+lesPaniers[j].idPagnet+'" name="clientInput" id="clientInput'+lesPaniers[j].idPagnet+'" autocomplete="off" placeholder="Client"/>'+

                                                    '<input type="number" class="avanceInput form-control col-md-2 col-sm-2 col-xs-3"  data-idPanier="'+lesPaniers[j].idPagnet+'" name="avanceInput" id="avanceInput'+lesPaniers[j].idPagnet+'" autocomplete="off" placeholder="Avance"/>'+

                                                    '<select class="compte  form-control col-md-2 col-sm-2 col-xs-3"   name="compte"  id="compteBon'+lesPaniers[j].idPagnet+'">'+
                                                        
                                                    '</select>'+    
                                                //'</div>'+

                                                // '<div id="compte_bon'+lesPaniers[j].idPagnet+'">'+

                                                //     '<input type="number" id="val_remise2'+lesPaniers[j].idPagnet+'" name="remise"  class="remise form-control col-md-2 col-sm-2 col-xs-3" placeholder="Remise....">'+
                                    
                                                //     '<select class="compte  form-control col-md-2 col-sm-2 col-xs-3"   name="compte"  id="compteBon'+lesPaniers[j].idPagnet+'" onChange="change1(this.value);">'+
                                                        
                                                //     '</select>'+

                                                //     '<input type="text" class="client clientInput form-control col-md-2 col-sm-2 col-xs-3"  data-type="simple" data-idPanier="'+lesPaniers[j].idPagnet+'" name="clientInput" id="clientInput'+lesPaniers[j].idPagnet+'" autocomplete="off" placeholder="Client"/>'+

                                                //     '<input type="number" class="avanceInput form-control col-md-2 col-sm-2 col-xs-3"  data-idPanier="'+lesPaniers[j].idPagnet+'" name="avanceInput" id="avanceInput'+lesPaniers[j].idPagnet+'" autocomplete="off" placeholder="Avance"/>'+

                                                //     '<select class="compteAvance 1751 form-control col-md-2 col-sm-2 col-xs-3"  data-idPanier="'+lesPaniers[j].idPagnet+'" name="compteAvance"  id="compteBon1'+lesPaniers[j].idPagnet+'">'+

                                                //     '</select>'+ 
                                                    
                                                // '</div>'+
                                                
                                                

                                                
                                                

                                                '<input type="hidden" name="idPagnet"   value='+lesPaniers[j].idPagnet+'>'+

                                                '<input type="hidden" name="totalp" id=totalp'+lesPaniers[j].idPagnet+' value="0" >'+

                                                '<button type="button" style="" name="btnImprimerFacture" data-idPanier='+lesPaniers[j].idPagnet+' id=btnImprimerFacture'+lesPaniers[j].idPagnet+' class="btn btn-success btn_Termine_Panier btn_Termine_Panier'+lesPaniers[j].idPagnet+' terminer" data-toggle="modal" ><span class="glyphicon glyphicon-ok"></span>'+

                                                    '<img src="images/loading-gif3.gif" class="img-load-terminer" style="height: 30px;width: 30px;display:none;" alt="GIF" srcset=""></button>'+

                                                '<button tabindex="1" type="button" class="btn btn-danger annuler" data-toggle="modal" data-target=#msg_ann_pagnet'+lesPaniers[j].idPagnet+'>'+

                                                    '<span class="glyphicon glyphicon-remove"></span>'+

                                                '</button>'+

                                            '</form>'+

                                            //<!--*******************************Fin Terminer Pagnet****************************************-->          

                                            //<!--*******************************Debut Annuler Pagnet****************************************-->


                                            '<div class="modal fade" id="msg_ann_pagnet'+lesPaniers[j].idPagnet+'" role="dialog">'+

                                                '<div class="modal-dialog">'+

                                                    //<!-- Modal content-->

                                                    '<div class="modal-content">'+

                                                        '<div class="modal-header panel-primary">'+

                                                            '<button type="button" class="close" data-dismiss="modal">&times;</button>'+

                                                            '<h4 class="modal-title">Confirmation</h4>'+

                                                        '</div>'+

                                                        '<form class="form-inline noImpr"  id="factForm" method="post"  >'+

                                                            '<div class="modal-body">'+

                                                                '<p>Voulez-vous annuler le panier numéro <b>'+lesPaniers[j].idPagnet+'</b></p>'+

                                                                '<input type="hidden" name="idPagnet" id="idPagnet"  value='+lesPaniers[j].idPagnet+'>'+

                                                            '</div>'+

                                                            '<div class="modal-footer">'+

                                                                '<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>'+

                                                                '<button type="button" name="btnAnnulerPagnet" data-idPanier='+lesPaniers[j].idPagnet+' class="btn btn-success btnAnnulerPagnet">Confirmer<img src="images/loading-gif3.gif" class="img-load-annulerPanier" style="height: 30px;width: 30px; display:none;" alt="GIF" srcset=""></button>'+

                                                            '</div>'+

                                                        '</form>'+

                                                    '</div>'+

                                                '</div>'+

                                            '</div>'+

                                            //<!--*******************************Fin Annuler Pagnet****************************************-->

                                        '</div>'+  

                                    '</div>'+

                                    '<table  id=tablePanier'+lesPaniers[j].idPagnet+' class="tabPanier table"  width="100%" >'+

                                        '<thead>'+

                                            '<tr>'+

                                                '<th>Référence</th>'+

                                                '<th>Quantité</th>'+

                                                '<th>Unité Vente</th>'+

                                                //<!-- <th class="hidden-sm hidden-xs">Unitévente</th>'+ -->

                                                '<th>Prix Unité Vente</th>'+

                                            '</tr>'+

                                        '</thead>'+

                                        '<tbody>'+
                                        
                                            

                                            
                                        '</tbody>'+

                                    '</table>'+

                                '</div>'+

                                '</div>'+
                            '</div>';

                        $("#accordion").prepend(p);

                        var lignes=JSON.parse(localStorage.getItem("ligne"));
                        
                        if(lignes!=null){
                            for(var i=0; i<lignes.length; i++){
                                if(lesPaniers[j].idPagnet==lignes[i].idPagnet){
                                    designations=getDesignation()
                                    searchDesignation=designations.find(d =>d.idDesignation==lignes[i].idDesignation); 
                                    
                                    nbreArticleUniteStok=searchDesignation.nbreArticleUniteStock

                                    //alert(nbreArticleUniteStok)
                                    if(lignes[i].unitevente!='Article' && lignes[i].unitevente!='article'){

                                        var l='<tr>' +

                                            '<td>' + lignes[i].designation + '</td>' +

                                            '<td><input class="form-control filedReadonly'+lignes[i].idPagnet+'" id="ligneQuantite'+lignes[i].idPagnet+' '+lignes[i].designation+' " onkeyup="modif_Quantite(this.value,'+lignes[i].numligne+')" value="' + lignes[i].quantite + '" style="width: 30%" type="number" ></input></td>' +
                                            //'<input type="text" id="nbreArticleUniteStock1" value="'+nbreArticleUniteStok+'"/>'+
                                            '<td>' +

                                                '<select class="form-control filedReadonly'+lignes[i].idPagnet+' " id="uniteVente'+lignes[i].unitevente+' " onchange="modif_UniteStock(this.value,'+lignes[i].numligne+', '+nbreArticleUniteStok+', '+lignes[i].idPagnet+')" >' +

                                                        '<option id="default" value="Caisse" >Caisse</option>'+

                                                        '<option  value="Article">Article</option>'+

                                                '</select>'+

                                            '</td>' +

                                            '<td><input  class="form-control" id="prixUniteStock'+lignes[i].idPagnet+''+lignes[i].designation+' " onkeyup="modif_Prix(this.value,'+lignes[i].numligne+')" value="' + (lignes[i].prixunitevente)*nbreArticleUniteStok + '" style="width: 70%" type="number"></input></td>' +


                                            '<td>'+

                                                '<button type="submit" 	 class="btn btn-warning pull-right btn_Retourner_Produit btn_Retourner_Produit'+lignes[i].idPagnet+'" data-toggle="modal" data-target="#msg_rtrnAvant_ligne'+lignes[i].numligne+'">'+

                                                        '<span class="glyphicon glyphicon-remove"></span>Retour'+

                                                '</button>'+

                                                '<div class="modal fade" id="msg_rtrnAvant_ligne'+lignes[i].numligne+'" role="dialog">'+

                                                    '<div class="modal-dialog">'+

                                                        //<!-- Modal content-->

                                                        '<div class="modal-content">'+

                                                            '<div class="modal-header panel-primary">'+

                                                                '<button type="button" class="close" data-dismiss="modal">&times;</button>'+

                                                                '<h4 class="modal-title">Confirmation</h4>'+

                                                            '</div>'+

                                                            '<form class="form-inline noImpr" id="factForm" method="post">'+

                                                                '<div class="modal-body">'+

                                                                    '<p>Voulez-vous annuler cette ligne du panier numéro <b>'+lignes[i].numligne+'</b></p>'+


                                                                '</div>'+

                                                                '<div class="modal-footer">'+

                                                                    '<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>'+

                                                                    '<button type="button" name="btnRetourAvant" data-numligne="'+lignes[i].numligne+'" class="btn btn-success btnRetourAvant">Confirmer</button>'+

                                                                '</div>'+

                                                            '</form>'+

                                                        '</div>'+

                                                    '</div>'+

                                                '</div>'+

                                                '</td>'+

                                            '</tr>';

                                            $("#tablePanier"+lesPaniers[j].idPagnet).prepend(l);

                                    }
                                    else{
                                        var l='<tr>' +

                                            '<td>' + lignes[i].designation + '</td>' +

                                            '<td><input class="form-control filedReadonly'+lignes[i].idPagnet+'" id="ligneQuantite'+lignes[i].idPagnet+' '+lignes[i].designation+' " onkeyup="modif_Quantite(this.value,'+lignes[i].numligne+')" value="' + lignes[i].quantite + '" style="width: 30%" type="number" ></input></td>' +
                                            //'<input type="text" id="nbreArticleUniteStock1" value="'+nbreArticleUniteStok+'"/>'+
                                            '<td>' +

                                                '<select class="form-control filedReadonly'+lignes[i].idPagnet+' " id="uniteVente'+lignes[i].unitevente+' " onchange="modif_UniteStock(this.value,'+lignes[i].numligne+', '+nbreArticleUniteStok+', '+lignes[i].idPagnet+')" >' +

                                                    '<option id="default" value="Article" >Article</option>'+

                                                    '<option  value="Caisse">Caisse</option>'+

                                                '</select>'+

                                            '</td>' +

                                            '<td><input  class="form-control" id="prixUniteStock'+lignes[i].idPagnet+''+lignes[i].designation+' " onkeyup="modif_Prix(this.value,'+lignes[i].numligne+')" value="' + lignes[i].prixunitevente + '" style="width: 70%" type="number"></input></td>' +


                                            '<td>'+

                                                '<button type="submit" 	 class="btn btn-warning pull-right btn_Retourner_Produit btn_Retourner_Produit'+lignes[i].idPagnet+'" data-toggle="modal" data-target="#msg_rtrnAvant_ligne'+lignes[i].numligne+'">'+

                                                        '<span class="glyphicon glyphicon-remove"></span>Retour'+

                                                '</button>'+

                                                '<div class="modal fade" id="msg_rtrnAvant_ligne'+lignes[i].numligne+'" role="dialog">'+

                                                    '<div class="modal-dialog">'+

                                                        //<!-- Modal content-->

                                                        '<div class="modal-content">'+

                                                            '<div class="modal-header panel-primary">'+

                                                                '<button type="button" class="close" data-dismiss="modal">&times;</button>'+

                                                                '<h4 class="modal-title">Confirmation</h4>'+

                                                            '</div>'+

                                                            '<form class="form-inline noImpr" id="factForm" method="post">'+

                                                                '<div class="modal-body">'+

                                                                    '<p>Voulez-vous annuler cette ligne du panier numéro <b>'+lignes[i].numligne+'</b></p>'+


                                                                '</div>'+

                                                                '<div class="modal-footer">'+

                                                                    '<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>'+

                                                                    '<button type="button" name="btnRetourAvant" data-numligne="'+lignes[i].numligne+'" class="btn btn-success btnRetourAvant">Confirmer</button>'+

                                                                '</div>'+

                                                            '</form>'+

                                                        '</div>'+

                                                    '</div>'+

                                                '</div>'+

                                                '</td>'+

                                            '</tr>';

                                            $("#tablePanier"+lesPaniers[j].idPagnet).prepend(l);

                                    }
                                    
                                    
                                    
                                }
                            }
                        }
                        
                    }  
                    
                }
            
            }
            $(".codeBarreLigneVt").focus();
            //localStorage.setItem('idCompte',1); 
            function remise() {
              //alert($("#val_remise1" + idPanier).val())
                $("#somme_Apayer" + idPanier).text((somme_A_payer()) - $("#val_remise1" + getIdPanier()).val());
            }
            document.getElementById("val_remise1" + getIdPanier()).onkeyup = function() {remise()};
            $("#somme_Total" + getIdPanier()).text(somme_A_payer());                       
            $("#somme_Apayer" + getIdPanier()).text((somme_A_payer()));
            $("#compteBon"+getIdPanier()).hide(); 
            $("#avanceInput"+getIdPanier()).hide();
            $("#clientInput"+getIdPanier()).hide(); 
                
        }

        function getIdPanier(){
            var idP=localStorage.getItem('IdPanier')
            return idP;
        }
        $("#compte_bon"+getIdPanier()).hide();
        document.getElementById("compteCaisse"+getIdPanier()).style.fontWeight = "bold";
        document.getElementById("versement"+getIdPanier()).style.fontWeight = "bold";
        document.getElementById("val_remise1"+getIdPanier()).style.fontWeight = "bold";

     
        lescomptes=JSON.parse(localStorage.getItem("Compte"));
        compteCaisse=lescomptes.filter(cpt =>cpt.nomCompte!='Caisse' && cpt.typeCompte=='compte mobile'); 
         
        compteBon=lescomptes.filter(cpt =>cpt.nomCompte!='Bon' && cpt.typeCompte=='compte mobile');
        compteCpt=lescomptes.filter(cpt =>cpt.nomCompte!='Bon' && cpt.nomCompte!='Caisse' && cpt.typeCompte=='compte mobile');
        
        var select = $("select#compteCaisse"+getIdPanier());
        var selectBon = $("select#compteBon"+getIdPanier());
    
        //Create optGroup
        var optGroup1 = $('<option/>', {
        //label: 0
        })
        $('<option>Caisse</option>', {
            
        }).appendTo(optGroup1);
        optGroup1.appendTo(select);
        
        for (var i = 0; i < compteCaisse.length; i++) {
            //Create option and append to optGroup created above
            //alert(comptes[i].nomCompte)
            var optGroup = $('<option/>', {
                label: compteCaisse[i].nomCompte
            })

            // var optGroup = $('<option/>', {
            //     label: compteCaisse[i].nomCompte
            // })

            $('<option>', {
                value: compteCaisse[i].idCompte,
                text: compteCaisse[i].nomCompte,
            
            }).appendTo(optGroup);

            
            optGroup.appendTo(select);
           
        }

        
        //var selectBon1 = $("select#compteBon1"+getIdPanier());


        //Create optGroup
        var optGroup2 = $('<option/>', {
        //label: 0
        })
        $('<option>Caisse</option>', {
            
        }).appendTo(optGroup2);
        optGroup2.appendTo(selectBon);
        
        for (var i = 0; i < compteCpt.length; i++) {
            //Create option and append to optGroup created above
            //alert(comptes[i].nomCompte)
            var optGroup2 = $('<option/>', {
            label: compteCpt[i].nomCompte
            })
            
            $('<option>', {
                value: compteCpt[i].idCompte,
                text: compteCpt[i].nomCompte,
                
            }).appendTo(optGroup2);
            optGroup2.appendTo(selectBon);
        }
        
        $('#compteCaisse'+getIdPanier()).change(function() {

                //var selected=[]; // create an array to hold all currently selected motivations
                
                $('#compteCaisse'+getIdPanier()+' option').each(function() {
                    // if it's selected, add it to the array above
                    if(this.selected){
                        if(this.text=='Bon'){
                            
                            $("#compteCaisse"+getIdPanier()).show();
                            $("#compteBon"+getIdPanier()).show();
                            document.getElementById("compteBon"+getIdPanier()).style.fontWeight = "bold";
                            //document.getElementById("compteBon1"+getIdPanier()).style.fontWeight = "bold";
                            //document.getElementById("val_remise1"+getIdPanier()).style.fontWeight = "bold";
                            $("#clientInput"+getIdPanier()).show();
                            $("#avanceInput"+getIdPanier()).show();
                            $("#versement"+getIdPanier()).hide();
                            document.getElementById("clientInput"+getIdPanier()).style.fontWeight = "bold";                           
                            document.getElementById("avanceInput"+getIdPanier()).style.fontWeight = "bold";
                            lesComptes=getCompte();
                            searchCompte=lesComptes.find(c =>c.nomCompte==this.text);  
                            if(searchCompte != undefined){
                                
                                //localStorage.setItem('idCompte',searchCompte.idCompte);
                                var paniers=getPagnet();
        
                                var searchPanier=paniers.find(p =>p.idPagnet==getIdPanier());
                                
                                if(searchPanier != undefined){
                                    searchPanier.idCompte=searchCompte.idCompte;
                                }
                                savePanier(paniers) 
                            }
                            
                            localStorage.setItem('typeVente','simple');
                        }
                        
                        if(this.text=='Caisse'){
                            $("#idPanier").load("container.html");
                            localStorage.setItem('typeVente','bon');
                            
                            lesComptes=getCompte();
                            searchCompte=lesComptes.find(c =>c.nomCompte==this.text);  
                            if(searchCompte != undefined){
                                
                                //localStorage.setItem('idCompte',searchCompte.idCompte); 
                                var paniers=getPagnet();
        
                                var searchPanier=paniers.find(p =>p.idPagnet==getIdPanier());
                                
                                if(searchPanier != undefined){
                                    searchPanier.idCompte=searchCompte.idCompte;
                                }
                                savePanier(paniers) 
                            }

                            lesClients=getClient();
                            searchClient=lesClients.find(c =>c.idClient==parseInt(idClient)); 
                            
                            if(searchClient != undefined){
                                
                                //localStorage.setItem('idCompte',searchCompte.idCompte);
                                var paniers=getPagnet();

                                var searchPanier=paniers.find(p =>p.idPagnet==getIdPanier());
                                
                                if(searchPanier != undefined){
                                    searchPanier.idClient=0;
                                }
                                savePanier(paniers) 

                    }
                        
                        
                        }
                    
                        
                        if(this.text!='Caisse' && this.text!='Bon'){
                            //alert('ok')
                            document.getElementById("versement"+getIdPanier()).disabled=true;
                            document.getElementById("versement"+getIdPanier()).placeholder = "";  
                            $("#versement"+getIdPanier()).show();
                            $("#compteBon"+getIdPanier()).hide(); 
                            $("#clientInput"+getIdPanier()).hide();
                            $("#avanceInput"+getIdPanier()).hide();

                            lesComptes=getCompte();
                            searchCompte=lesComptes.find(c =>c.nomCompte==this.text);  
                            if(searchCompte != undefined){
                                
                                //localStorage.setItem('idCompte',searchCompte.idCompte);
                                var paniers=getPagnet();
        
                                var searchPanier=paniers.find(p =>p.idPagnet==getIdPanier());
                                
                                if(searchPanier != undefined){
                                    searchPanier.idCompte=searchCompte.idCompte;
                                }
                                savePanier(paniers) 

                            }
                        }

                        
                    }
                })
                
                
        })
        $('#compteBon'+getIdPanier()).change(function() {
            $('#compteBon'+getIdPanier()+' option').each(function() {
                    // if it's selected, add it to the array above
                    if(this.selected){                          
                        lesComptes=getCompte();
                        searchCompte=lesComptes.find(c =>c.nomCompte== this.text);  
                        if(searchCompte != undefined){
                            
                            localStorage.setItem('idCompte2',searchCompte.idCompte);
                             
                        }       
                    }
            })

        })
        localStorage.setItem('typeVente','bon');
            
        //localStorage.setItem('idCompte',searchCompte.idCompte);
        var paniers=getPagnet();

        var searchPanier=paniers.find(p =>p.idPagnet==getIdPanier());
        
        if(searchPanier != undefined){
            searchPanier.idClient=0;
            searchPanier.idCompte=1;
        }
        savePanier(paniers) 


                        
    </script>

<!-- Fin Javascript de l'Accordion pour Tout les Paniers -->



<!-- Debut de l'Accordion pour Tout les Paniers -->

    <div class="panel-group" id="accordion">

        <!-- Debut Boucle while concernant les Paniers en cours (2 aux maximum) -->  
    
                      
            
        <!-- Fin Boucle while concernant les Paniers en cours (2 aux maximum) -->


        <!-- Debut Boucle while concernant les Paniers Vendus -->

    
        <!-- Fin Boucle while concernant les Paniers Vendus  -->
    </div>


<!-- Fin de l'Accordion pour Tout les Paniers -->



<script>$(document).ready(function(){$("#AjoutLigne").click(function(){$("#AjoutLigneModal").modal();});});</script></body></html>